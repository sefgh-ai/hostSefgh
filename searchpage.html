<!DOCTYPE html>
<html lang="en" class="light">
<head>
      <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-3J37CNB3YE"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-3J37CNB3YE");
    </script>

    <meta
      name="description"
      content="Discover hidden GitHub gems with SEFGH's intelligent search. Go beyond keywords with natural language queries and find projects that truly match your needs. Perfect for developers, data scientists, and researchers."
    />
    <meta
      name="keywords"
      content="GitHub search tool, GitHub project discovery, smart GitHub search, find GitHub projects, GitHub repository search engine, discover GitHub gems, open source project finder"
    />
    <meta name="author" content="SEFGH" />
    <meta name="robots" content="index, follow" />

    <!-- Canonical URL -->
    <link rel="canonical" href="https://sefgh.org/searchpage" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://sefgh.org/searchpage" />
    <meta
      property="og:title"
      content="SEFGH - Search Engine For Github, Smart GitHub Project Discovery Tool"
    />
    <meta
      property="og:description"
      content="Discover hidden GitHub gems with SEFGH's intelligent search. Go beyond keywords with natural language queries and find projects that truly match your needs."
    />
    <meta
      property="og:image"
      content="https://sefgh.org/assets/sefgh-social-preview.jpg"
    />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:site_name" content="SEFGH" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://sefgh.org/searchpage" />
    <meta property="twitter:title" content="SEFGH - Search Engine For Github" />
    <meta
      property="twitter:description"
      content="Discover hidden GitHub gems with SEFGH's intelligent search. Go beyond keywords with natural language queries and find projects that truly match your needs."
    />
    <meta
      property="twitter:image"
      content="https://sefgh.org/assets/sefgh-social-preview.jpg"
    />
    <meta name="twitter:creator" content="@sefgh" />
    <meta name="twitter:site" content="@sefgh" />

    <!-- Additional Meta Tags -->
    <meta name="application-name" content="SEFGH" />
    <meta name="theme-color" content="#2563eb" />
    <meta name="msapplication-TileColor" content="#2563eb" />

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "SEFGH",
        "url": "https://sefgh.org/searchpage",
        "description": "A smart GitHub project discovery tool that helps developers find repositories using natural language queries and intelligent matching based on LLM'S Agentic Frameworks.",
        "applicationCategory": "DeveloperApplication",
        "operatingSystem": "Web Browser",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        },
        "creator": {
          "@type": "Organization",
          "name": "SEFGH",
          "url": "https://sefgh.org/searchpage"
        },
        "featureList": [
          "Natural language GitHub search",
          "Multi-language project discovery",
          "Smart repository matching",
          "Hidden gem discovery",
          "Detailed project analysis",
          "Search Engine For Github"
        ]
      }
    </script>

    <!-- Additional Structured Data for Organization -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "SEFGH",
        "url": "https://sefgh.org/searchpage",
        "logo": "https://sefgh.org/assets/sefgh-logo.png",
        "description": "SEFGH is a smart GitHub project discovery tool that helps developers find repositories using natural language queries.",
        "foundingDate": "2025",
        "sameAs": ["https://twitter.com/sefghai", "https://github.com/sefgh-ai"]
      }
    </script>


    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-i18n="pageTitle">SEFGH - AI-Powered GitHub Repository Search</title>
    <link rel="icon" type="image/png" href="./assets/favicon.png" />
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Using Inter for all text to match the provided image's clean sans-serif style -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Meta Tags -->
    <meta name="description" content="Discover and explore GitHub repositories with AI-powered chat assistance. Search, filter, and analyze projects with intelligent recommendations." />
    <meta name="keywords" content="GitHub, repositories, search, AI, chat, development, code, projects" />
    <meta name="theme-color" content="#111827" />
    
    <!-- CDNs for Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Marked.js for Markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>


    <!-- Custom Tailwind Configuration -->
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            fontFamily: {
              // Removed 'stalinist' and kept 'inter' as the primary font
              'sans': ['Inter', 'sans-serif'], // Set Inter as the default sans-serif font
            },
            colors: {
                // Custom modern palette
                primary: {
                    50: '#eef2ff',
                    100: '#e0e7ff',
                    200: '#c7d2fe',
                    300: '#a5b4fc',
                    400: '#818cf8',
                    500: '#6366f1', // Main accent blue
                    600: '#4f46e5',
                    700: '#4338ca',
                    800: '#3730a3',
                    900: '#312e81',
                    950: '#1e1b4b',
                },
                gray: {
                    50: '#f9fafb',
                    100: '#f3f4f6',
                    200: '#e5e7eb',
                    300: '#d1d5db',
                    400: '#9ca3af',
                    500: '#6b7280',
                    600: '#4b5563',
                    700: '#374151',
                    800: '#1f2937',
                    900: '#111827', // Darkest background
                    950: '#030712', // True black for dark mode
                },
            },
            animation: {
              'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
              'rainbow-shine': 'rainbow-shine 2s linear infinite',
              'fade-in-up': 'fade-in-up 0.5s ease-out forwards',
              'bounce-in': 'bounce-in 0.8s ease-out forwards', /* New animation */
            },
            keyframes: {
              'rainbow-shine': {
                '0%': { 'background-position': '0% 50%' },
                '100%': { 'background-position': '200% 50%' },
              }
            }
          }
        }
      }
    </script>

    <!-- Custom CSS Styles -->
    <style type="text/tailwindcss">
      @layer base {
        html { scroll-behavior: smooth; }
        /* Updated body to use Inter as the default font */
        body { @apply antialiased bg-gray-50 dark:bg-gray-950 text-gray-800 dark:text-gray-200 font-sans overflow-hidden; } /* RE-ADDED overflow-hidden */
      }
      @layer utilities {
        .backdrop-blur-md { backdrop-filter: blur(12px); }
        /* Updated active/inactive nav colors for better contrast */
        .active-nav { @apply bg-primary-100 dark:bg-primary-800 text-primary-800 dark:text-primary-100 font-medium; }
        .inactive-nav { @apply text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700/60; }

        .hover-rainbow-shine {
            @apply bg-clip-text text-transparent;
        }
        .hover-rainbow-shine:hover {
            background-image: linear-gradient(to right, #ef4444, #f97316, #eab308, #84cc16, #22c55e, #14b8a6, #06b6d4, #3b82f6, #8b5cf6, #d946ef, #ef4444);
            background-size: 200% auto;
            @apply animate-rainbow-shine;
        }
      }

      /* Custom scrollbar */
      ::-webkit-scrollbar { width: 8px; height: 8px; }
      ::-webkit-scrollbar-track { @apply bg-gray-100 dark:bg-gray-800; }
      ::-webkit-scrollbar-thumb { @apply bg-gray-400 dark:bg-gray-600 rounded-full; }
      ::-webkit-scrollbar-thumb:hover { @apply bg-gray-500 dark:bg-gray-500; }

      /* Focus & Selection */
      /* Updated focus ring color */
      :focus-visible { @apply ring-2 ring-primary-500 ring-offset-2 ring-offset-white dark:ring-offset-gray-900 outline-none; }
      ::selection { @apply bg-primary-700 text-white; }
      ::-moz-selection { @apply bg-primary-700 text-white; }

      /* Panel transition styles */
      #nav-panel, #chat-panel, #search-panel {
        transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      /* Dropdown transition */
      #version-menu {
        transition: opacity 150ms ease-out, transform 150ms ease-out;
      }

      /* Notification styles */
      #notification-container {
          position: fixed;
          top: 1rem;
          left: 50%;
          transform: translateX(-50%);
          z-index: 1000;
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
          width: 90%;
          max-width: 400px;
      }
      .notification-item {
          @apply p-3 rounded-lg shadow-lg flex items-center justify-between text-sm;
          animation: slideIn 0.3s ease-out forwards, fadeOut 0.5s ease-in 6.5s forwards; /* Increased duration to 7s (6.5s fadeOut delay) */
      }
      .notification-item.info {
          @apply bg-blue-500 text-white; /* Changed to blue-500 */
      }
      .notification-item.error {
          @apply bg-red-500 text-white; /* Changed to red-500 */
      }
      .notification-item.success {
          @apply bg-green-500 text-white; /* Changed to green-500 */
      }

      @keyframes slideIn {
          from { transform: translateY(-20px); opacity: 0; }
          to { transform: translateY(0); opacity: 1; }
      }
      @keyframes fadeOut {
          from { opacity: 1; }
          to { opacity: 0; }
      }
    </style>
</head>
<body class="flex">

    <div id="app-container" class="h-screen flex flex-col flex-1">

        <!-- Header -->
        <header class="h-16 bg-white/80 dark:bg-gray-950/80 backdrop-blur-md flex items-center justify-between px-2 sm:px-4 md:px-6 z-50 flex-shrink-0">
            <div class="flex items-center space-x-1 sm:space-x-2 flex-nowrap">
                <!-- Updated logo text to use Inter font with extra-bold weight -->
                <!-- Hide on mobile, show on desktop -->
                <a id="main-header-logo" href="https://sefgh.org" rel="noopener noreferrer" class="text-base sm:text-lg lg:text-xl font-extrabold font-sans hover-rainbow-shine bg-gradient-to-r from-gray-900 to-gray-900 dark:from-gray-200 dark:to-gray-200 flex-shrink-0 hidden md:block">SEFGH-AI</a>

                <!-- Re-introduced Version Switcher Dropdown in Header -->
                <div id="version-switcher" class="relative ml-4 flex-shrink-0">
                    <button id="version-toggle-btn" class="flex items-center space-x-2 px-3 py-2 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors shadow-sm">
                        <span id="version-name" class="font-semibold text-xs sm:text-sm text-gray-900 dark:text-white flex-shrink-0"></span>
                        <i id="version-chevron" data-lucide="chevron-down" class="w-4 h-4 text-primary-500 flex-shrink-0"></i>
                    </button>
                    <div id="version-menu" class="absolute top-full left-0 mt-2 w-56 bg-white dark:bg-gray-900/95 backdrop-blur-md rounded-lg shadow-xl z-10 hidden origin-top-left" style="transform: scale(0.95); opacity: 0;">
                        <!-- Version items will be injected by JS -->
                    </div>
                </div>
            </div>
            <div class="flex items-center space-x-1 sm:space-x-2 md:space-x-4 flex-nowrap">
                <!-- GitHub icon button - Hide on mobile, show on desktop -->
                <button title="GitHub Repository" class="p-2 rounded-lg text-purple-600 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors flex-shrink-0 hidden md:block" id="main-header-github-btn">
                    <i data-lucide="github" class="w-5 h-5"></i>
                </button>
                <!-- New layout grid icon button (renamed to toggle-nav-btn) -->
                <button id="toggle-nav-btn" title="Toggle Navigation" class="p-2 rounded-lg text-teal-500 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors flex-shrink-0">
                    <i data-lucide="layout-grid" class="w-5 h-5"></i>
                </button>
                <button id="toggle-search-btn" title="Show Search" class="p-2 rounded-lg text-blue-500 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors flex-shrink-0">
                    <i data-lucide="search" class="w-5 h-5"></i>
                </button>
                <!-- Theme toggle button - Hide on mobile, show on desktop -->
                <button id="theme-toggle-btn" title="Toggle theme" class="p-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors flex-shrink-0 hidden md:block">
                    <i data-lucide="moon" class="w-5 h-5"></i>
                </button>
                <button id="user-account-btn" title="User Account" class="p-2 rounded-lg text-green-500 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors flex-shrink-0" onclick="window.open('https://v1.sefgh.org/login', '_blank')">
                    <i data-lucide="user" class="w-5 h-5"></i>
                </button>
            </div>
        </header>

        <!-- Main Content Area -->
        <!-- Added gap-x-2 for visual separation between panels -->
        <main id="panel-container" class="flex-1 flex relative md:gap-x-2 overflow-hidden">
            
            <!-- Navigation Panel (New Sidebar) -->
            <nav id="nav-panel" class="h-full flex flex-col bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 flex-shrink-0 hidden" style="width: 240px;">
                <!-- Mobile Header within Nav Panel (NEW) -->
                <div id="mobile-nav-header" class="md:hidden flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 flex-shrink-0">
                    <a href="https://sefgh.org" rel="noopener noreferrer" class="text-base sm:text-lg font-extrabold font-sans hover-rainbow-shine bg-gradient-to-r from-gray-900 to-gray-900 dark:from-gray-200 dark:to-gray-200 flex-shrink-0">SEFGH-AI</a>
                    <div class="flex items-center space-x-2">
                        <button id="mobile-nav-github-btn" title="GitHub Repository" class="p-2 rounded-lg text-purple-600 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors flex-shrink-0" >
                            <i data-lucide="github" class="w-5 h-5"></i>
                        </button>
                        <button id="mobile-nav-theme-toggle-btn" title="Toggle theme" class="p-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors flex-shrink-0">
                            <i data-lucide="moon" class="w-5 h-5"></i>
                        </button>
                    </div>
                </div>
                <div class="p-4 flex-shrink-0">
                    <h2 data-i18n="navigationTitle" class="text-lg font-semibold text-gray-800 dark:text-gray-200">Navigation</h2>
                </div>
                <div id="nav-items-container" class="flex-1 overflow-y-auto p-4 space-y-1 min-h-0">
                    <button class="nav-item w-full text-left p-2 rounded-lg flex items-center space-x-3 transition-colors" data-view="chat" data-i18n="newChat">
                        <i data-lucide="message-square" class="w-5 h-5"></i>
                        <span>New Chat</span>
                    </button>
                    <button class="nav-item w-full text-left p-2 rounded-lg flex items-center space-x-3 transition-colors" data-view="chat-history" data-i18n="chatHistory">
                        <i data-lucide="history" class="w-5 h-5"></i>
                        <span>Chat History</span>
                    </button>
                    <button class="nav-item w-full text-left p-2 rounded-lg flex items-center space-x-3 transition-colors" data-view="docs" data-i18n="docs">
                        <i data-lucide="book" class="w-5 h-5"></i>
                       <span>Docs</span> 
                    </button>
                    <button class="nav-item w-full text-left p-2 rounded-lg flex items-center space-x-3 transition-colors" data-view="playground" data-i18n="playground">
                        <i data-lucide="flask-conical" class="w-5 h-5"></i>
                      <span>Playground</span>
                    </button>
                    <button class="nav-item w-full text-left p-2 rounded-lg flex items-center space-x-3 transition-colors" data-view="console" data-i18n="console">
                        <i data-lucide="terminal" class="w-5 h-5"></i>
                        <span>Console</span>
                    </button>
                    <button class="nav-item w-full text-left p-2 rounded-lg flex items-center space-x-3 transition-colors" data-view="proxy" data-i18n="proxy">
                        <i data-lucide="shield" class="w-5 h-5"></i>
                        <span>Proxy</span>
                    </button>
                    <button class="nav-item w-full text-left p-2 rounded-lg flex items-center space-x-3 transition-colors" data-view="language" data-i18n="language">
                        <i data-lucide="globe" class="w-5 h-5"></i>
                        <span>Language</span>
                    </button>
                    <button class="nav-item w-full text-left p-2 rounded-lg flex items-center space-x-3 transition-colors" data-view="settings" data-i18n="settings">
                        <i data-lucide="settings" class="w-5 h-5"></i>
                        <span>Settings</span>
                    </button>
                    <!-- NEW: All Pages Navigation Item -->
                    <button class="nav-item w-full text-left p-2 rounded-lg flex items-center space-x-3 transition-colors" data-view="all-pages" data-i18n="allPages">
                        <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                        <span>All Pages</span>
                    </button>
                </div>
            </nav>

            <!-- Navigation Resize Handle -->
            <div id="nav-resize-handle" class="w-1 h-full bg-gray-300 dark:bg-gray-700 hover:bg-gray-500 dark:hover:bg-gray-600 cursor-col-resize flex-shrink-0 transition-colors hidden md:flex items-center justify-center">
                 <div class="w-1.5 h-8 bg-gray-600 dark:bg-gray-500 rounded-full opacity-100"></div>
            </div>
            
            <!-- Main Content Wrapper -->
            <div id="main-content-wrapper" class="flex-1 flex flex-col">
                <!-- Chat Panel -->
                <section id="chat-panel" class="h-full flex flex-col bg-white dark:bg-gray-950 w-full">
                    <div class="flex items-center justify-end p-4 flex-shrink-0">
                        <button id="clear-history-btn" title="Clear chat history" class="p-2 text-red-500 hover:text-red-600 dark:hover:text-red-400 transition-colors hidden">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                        </button>
                    </div>
                    <div id="messages-container" class="flex-1 overflow-y-auto p-4 space-y-4 min-h-0"></div>
                    <form id="chat-form" class="py-2 px-2 sm:px-4 bg-white/80 dark:bg-gray-950/80 backdrop-blur-md flex-shrink-0">
                        <div class="flex items-center space-x-2 flex-nowrap">
                            <button type="button" title="Find similar repos" class="p-2 text-orange-500 hover:text-orange-600 dark:hover:text-orange-400 transition-colors flex-shrink-0"><i data-lucide="paperclip" class="w-5 h-5"></i></button>
                            <div class="flex-1 relative min-w-0">
                                <textarea id="chat-textarea" data-i18n="chatPlaceholder" placeholder="e.g., 'Find a lightweight charting library for React'" rows="1" class="w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg resize-none text-sm max-h-32"></textarea>
                            </div>
                            <button id="send-btn" type="submit" title="Send message" class="p-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-md flex-shrink-0">
                                <i data-lucide="send" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </form>
                    <div data-i18n="disclaimer" class="text-xs text-center text-gray-500 dark:text-gray-400 py-1 px-2 sm:px-4">
                        SEFGH-Ai is evolving. Confirm essential information
                    </div>
                </section>

                <!-- History Panel (Now used for Chat History) -->
                <section id="history-panel" class="h-full w-full flex-col bg-gray-50 dark:bg-gray-900 hidden">
                     <div class="p-4 flex-shrink-0 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                        <h2 data-i18n="chatHistoryTitle" class="text-lg font-semibold text-gray-800 dark:text-gray-200">Chat History</h2>
                        <button id="clear-search-history-btn" title="Clear chat history" class="p-2 text-gray-400 hover:text-red-500 dark:hover:text-red-400 transition-colors">
                            <i data-lucide="trash-2" class="w-5 h-5"></i>
                        </button>
                     </div>
                     <div id="history-container" class="flex-1 overflow-y-auto p-4 min-h-0">
                        <!-- History items will be injected here -->
                        <div class="text-center text-gray-500 dark:text-gray-400 mt-8">
                            <i data-lucide="history" class="w-16 h-16 mx-auto mb-4 text-primary-400"></i>
                            <h3 data-i18n="noChatHistory" class="text-lg font-medium mb-2">No Chat History</h3>
                            <p data-i18n="chatHistoryEmptyMessage" class="text-sm">Your past conversations will appear here.</p>
                        </div>
                     </div>
                </section>

                <!-- Proxy Panel (New) -->
                <section id="proxy-panel" class="h-full w-full flex-col bg-gray-50 dark:bg-gray-900 hidden">
                    <div class="p-4 flex-shrink-0 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                        <h2 data-i18n="proxySettingsTitle" class="text-lg font-semibold text-gray-800 dark:text-gray-200">Proxy Settings</h2>
                    </div>
                    <div class="flex-1 overflow-y-auto p-4 text-gray-600 dark:text-gray-300 min-h-0">
                        <p data-i18n="proxyDescription" class="mb-4">Configure your proxy settings here.</p>
                        <!-- Example proxy settings form -->
                        <form class="space-y-4">
                            <div>
                                <label for="proxy-address" data-i18n="proxyAddressLabel" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Proxy Address</label>
                                <input type="text" id="proxy-address" class="mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm" placeholder="e.g., http://myproxy.com:8080">
                            </div>
                            <div>
                                <label for="proxy-username" data-i18n="proxyUsernameLabel" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Username (Optional)</label>
                                <input type="text" id="proxy-username" class="mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm">
                            </div>
                            <div>
                                <label for="proxy-password" data-i18n="proxyPasswordLabel" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Password (Optional)</label>
                                <input type="password" id="proxy-password" class="mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:text-sm">
                            </div>
                            <button type="submit" data-i18n="saveProxySettingsBtn" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                                Save Proxy Settings
                            </button>
                        </form>
                    </div>
                </section>

                <!-- Language Panel (New) -->
                <section id="language-panel" class="h-full w-full flex-col bg-gray-50 dark:bg-gray-900 hidden">
                    <div class="p-4 flex-shrink-0 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                        <h2 data-i18n="languageSettingsTitle" class="text-lg font-semibold text-gray-800 dark:text-gray-200">Language Settings</h2>
                    </div>
                    <div class="flex-1 overflow-y-auto p-4 text-gray-600 dark:text-gray-300 min-h-0">
                        <p data-i18n="languageDescription" class="mb-4">Select your preferred language for the application interface:</p>
                        <div class="mt-4 space-y-2">
                            <button class="lang-select-btn w-full text-left p-3 rounded-xl transition-colors flex items-center space-x-3" data-lang="en">
                                <span class="lang-check-icon"><i data-lucide="circle" class="w-5 h-5 text-gray-400"></i></span>
                                <span>English (EN)</span>
                            </button>
                            <button class="lang-select-btn w-full text-left p-3 rounded-xl transition-colors flex items-center space-x-3" data-lang="es">
                                <span class="lang-check-icon"><i data-lucide="circle" class="w-5 h-5 text-gray-400"></i></span>
                                <span>Español (ES)</span>
                            </button>
                            <button class="lang-select-btn w-full text-left p-3 rounded-xl transition-colors flex items-center space-x-3" data-lang="fr">
                                <span class="lang-check-icon"><i data-lucide="circle" class="w-5 h-5 text-gray-400"></i></span>
                                <span>Français (FR)</span>
                            </button>
                            <button class="lang-select-btn w-full text-left p-3 rounded-xl transition-colors flex items-center space-x-3" data-lang="de">
                                <span class="lang-check-icon"><i data-lucide="circle" class="w-5 h-5 text-gray-400"></i></span>
                                <span>Deutsch (DE)</span>
                            </button>
                            <button class="lang-select-btn w-full text-left p-3 rounded-xl transition-colors flex items-center space-x-3" data-lang="ja">
                                <span class="lang-check-icon"><i data-lucide="circle" class="w-5 h-5 text-gray-400"></i></span>
                                <span>日本語 (JA)</span>
                            </button>
                            <button class="lang-select-btn w-full text-left p-3 rounded-xl transition-colors flex items-center space-x-3" data-lang="zh">
                                <span class="lang-check-icon"><i data-lucide="circle" class="w-5 h-5 text-gray-400"></i></span>
                                <span>中文 (ZH)</span>
                            </button>
                            <button class="lang-select-btn w-full text-left p-3 rounded-xl transition-colors flex items-center space-x-3" data-lang="hi">
                                <span class="lang-check-icon"><i data-lucide="circle" class="w-5 h-5 text-gray-400"></i></span>
                                <span>हिन्दी (HI)</span>
                            </button>
                            <button class="lang-select-btn w-full text-left p-3 rounded-xl transition-colors flex items-center space-x-3" data-lang="te">
                                <span class="lang-check-icon"><i data-lucide="circle" class="w-5 h-5 text-gray-400"></i></span>
                                <span>తెలుగు (TE)</span>
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Placeholder for other panels like Settings, Console, Playground, Docs -->
                <section id="settings-panel" class="h-full w-full flex-col bg-gray-50 dark:bg-gray-900 hidden">
                    <div class="p-4 flex-shrink-0 border-b border-gray-200 dark:border-gray-700">
                        <h2 data-i18n="settingsTitle" class="text-lg font-semibold text-gray-800 dark:text-gray-200">Settings</h2>
                    </div>
                    <div class="flex-1 overflow-y-auto p-4 text-gray-600 dark:text-gray-300 min-h-0">
                        <p data-i18n="settingsDescription">Application settings will be configured here.</p>
                    </div>
                </section>
                <section id="console-panel" class="h-full w-full flex-col bg-gray-50 dark:bg-gray-900 hidden">
                    <div class="p-4 flex-shrink-0 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                        <h2 data-i18n="consoleTitle" class="text-lg font-semibold text-gray-800 dark:text-gray-200">Console</h2>
                        <div class="flex space-x-2">
                            <button id="copy-log-btn" title="Copy console log" class="p-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                                <i data-lucide="copy" class="w-5 h-5"></i>
                            </button>
                            <button id="download-log-btn" title="Download console log" class="p-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                                <i data-lucide="download" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>
                    <div id="console-output" class="flex-1 overflow-y-auto p-4 text-xs font-mono bg-gray-900 text-gray-100 min-h-0">
                        <!-- Console logs will be injected here -->
                    </div>
                </section>
                <section id="docs-panel" class="h-full w-full flex-col bg-gray-50 dark:bg-gray-900 hidden">
                    <div class="p-4 flex-shrink-0 border-b border-gray-200 dark:border-gray-700">
                        <h2 data-i18n="docsTitle" class="text-lg font-semibold text-gray-800 dark:text-gray-200">Documentation</h2>
                    </div>
                    <div class="flex-1 overflow-y-auto p-4 text-gray-600 dark:text-gray-300 min-h-0">
                        <p data-i18n="docsDescription">Documentation for SEFGH will be displayed here.</p>
                         <a href="https://docs.sefgh.org" target="_blank" class="text-blue-500 hover:text-blue-700 underline">Click here for docs</a>
                    </div>
                </section>
                <section id="playground-panel" class="h-full w-full flex-col bg-gray-50 dark:bg-gray-900 hidden">
                    <div class="p-4 flex-shrink-0 border-b border-gray-200 dark:border-gray-700">
                        <h2 data-i18n="playgroundTitle" class="text-lg font-semibold text-gray-800 dark:text-gray-200">Playground</h2>
                    </div>
                    <div class="flex-1 overflow-y-auto p-4 text-gray-600 dark:text-gray-300 min-h-0">
                        <p data-i18n="playgroundDescription">Experiment with SEFGH features in this playground.</p>
                          <a href="https://playground.sefgh.org" target="_blank" class="text-blue-500 hover:text-blue-700 underline">Click here for playground</a>
                    </div>
                </section>

                <!-- NEW: All Pages Panel -->
                <section id="all-pages-panel" class="h-full w-full flex-col bg-gray-50 dark:bg-gray-900 hidden">
                    <div class="p-4 flex-shrink-0 border-b border-gray-200 dark:border-gray-700">
                        <h2 data-i18n="allPagesTitle" class="text-lg font-semibold text-gray-800 dark:text-gray-200">All Pages</h2>
                    </div>
                    <div class="flex-1 overflow-y-auto p-4 text-gray-600 dark:text-gray-300 min-h-0">
                        <p data-i18n="allPagesDescription" class="mb-6">Explore all available sections of the SEFGH application.</p>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            <!-- Page links will be injected here by JS -->
                            <button class="page-link-card w-full text-left p-4 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-md hover:shadow-lg hover:border-primary-500 dark:hover:border-primary-400 transition-all duration-200 flex items-center space-x-4" data-view="chat">
                                <i data-lucide="message-square" class="w-6 h-6 text-primary-500 flex-shrink-0"></i>
                                <div>
                                    <h3 class="font-semibold text-gray-800 dark:text-gray-200" data-i18n="newChat">New Chat</h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Start a new conversation with the AI.</p>
                                </div>
                            </button>
                            <button class="page-link-card w-full text-left p-4 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-md hover:shadow-lg hover:border-primary-500 dark:hover:border-primary-400 transition-all duration-200 flex items-center space-x-4" data-view="chat-history">
                                <i data-lucide="history" class="w-6 h-6 text-primary-500 flex-shrink-0"></i>
                                <div>
                                    <h3 class="font-semibold text-gray-800 dark:text-gray-200" data-i18n="chatHistory">Chat History</h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Review your past conversations.</p>
                                </div>
                            </button>
                             <button class="page-link-card w-full text-left p-4 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-md hover:shadow-lg hover:border-primary-500 dark:hover:border-primary-400 transition-all duration-200 flex items-center space-x-4" data-view="docs">
                                <i data-lucide="book" class="w-6 h-6 text-primary-500 flex-shrink-0"></i>
                                <div>
                                    <h3 class="font-semibold text-gray-800 dark:text-gray-200" data-i18n="docs">Docs</h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Access documentation and guides.</p>
                                </div>
                            </button>
                            <button class="page-link-card w-full text-left p-4 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-md hover:shadow-lg hover:border-primary-500 dark:hover:border-primary-400 transition-all duration-200 flex items-center space-x-4" data-view="playground">
                                <i data-lucide="flask-conical" class="w-6 h-6 text-primary-500 flex-shrink-0"></i>
                                <div>
                                    <h3 class="font-semibold text-gray-800 dark:text-gray-200" data-i18n="playground">Playground</h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Experiment with features in a sandbox.</p>
                                </div>
                            </button>
                            <button class="page-link-card w-full text-left p-4 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-md hover:shadow-lg hover:border-primary-500 dark:hover:border-primary-400 transition-all duration-200 flex items-center space-x-4" data-view="console">
                                <i data-lucide="terminal" class="w-6 h-6 text-primary-500 flex-shrink-0"></i>
                                <div>
                                    <h3 class="font-semibold text-gray-800 dark:text-gray-200" data-i18n="console">Console</h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">View real-time application logs.</p>
                                </div>
                            </button>
                            <button class="page-link-card w-full text-left p-4 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-md hover:shadow-lg hover:border-primary-500 dark:hover:border-primary-400 transition-all duration-200 flex items-center space-x-4" data-view="proxy">
                                <i data-lucide="shield" class="w-6 h-6 text-primary-500 flex-shrink-0"></i>
                                <div>
                                    <h3 class="font-semibold text-gray-800 dark:text-gray-200" data-i18n="proxy">Proxy</h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Configure network proxy settings.</p>
                                </div>
                            </button>
                            <button class="page-link-card w-full text-left p-4 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-md hover:shadow-lg hover:border-primary-500 dark:hover:border-primary-400 transition-all duration-200 flex items-center space-x-4" data-view="language">
                                <i data-lucide="globe" class="w-6 h-6 text-primary-500 flex-shrink-0"></i>
                                <div>
                                    <h3 class="font-semibold text-gray-800 dark:text-gray-200" data-i18n="language">Language</h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Change the application language.</p>
                                </div>
                            </button>
                            <button class="page-link-card w-full text-left p-4 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-md hover:shadow-lg hover:border-primary-500 dark:hover:border-primary-400 transition-all duration-200 flex items-center space-x-4" data-view="settings">
                                <i data-lucide="settings" class="w-6 h-6 text-primary-500 flex-shrink-0"></i>
                                <div>
                                    <h3 class="font-semibold text-gray-800 dark:text-gray-200" data-i18n="settings">Settings</h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Adjust application preferences.</p>
                                </div>
                            </button>
                            <button class="page-link-card w-full text-left p-4 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-md hover:shadow-lg hover:border-primary-500 dark:hover:border-primary-400 transition-all duration-200 flex items-center space-x-4" data-view="search">
                                <i data-lucide="search" class="w-6 h-6 text-primary-500 flex-shrink-0"></i>
                                <div>
                                    <h3 class="font-semibold text-gray-800 dark:text-gray-200" data-i18n="repoSearchTitle">Repo Search</h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Search GitHub repositories.</p>
                                </div>
                            </button>
                        </div>
                    </div>
                </section>
            </div>


            <!-- Search Panel Resize Handle -->
            <div id="search-resize-handle" class="w-1 h-full bg-gray-300 dark:bg-gray-700 hover:bg-gray-500 dark:hover:bg-gray-600 cursor-col-resize flex-shrink-0 transition-colors hidden md:flex items-center justify-center">
                 <div class="w-1.5 h-8 bg-gray-600 dark:bg-gray-500 rounded-full opacity-100"></div>
            </div>

            <!-- Search Panel -->
            <section id="search-panel" class="h-full w-full flex-col bg-gray-50 dark:bg-gray-900 absolute inset-0 md:relative hidden">
                <!-- New header for search panel -->
                <div class="flex items-center justify-between py-2 px-4 flex-shrink-0">
                    <div class="flex items-center space-x-2">
                        <i data-lucide="github" class="w-6 h-6 text-gray-600 dark:text-gray-400"></i>
                        <span data-i18n="repoSearchTitle" class="text-base font-semibold text-gray-800 dark:text-gray-200">Repo Search</span>
                    </div>
                    <button id="close-search-panel-btn" title="Close Search" class="p-2 rounded-full text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
                 <div class="pt-2 px-4 flex-shrink-0">
                    <div class="relative">
                        <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"></i>
                        <!-- Updated search input style -->
                        <input id="search-input" type="text" data-i18n="searchPlaceholder" placeholder="Search GitHub repositories..." class="w-full pl-10 pr-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg text-sm shadow-sm">
                        <!-- Clear Search Input Button -->
                        <button id="clear-search-input-btn" title="Clear search" class="absolute right-3 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hidden">
                            <i data-lucide="x" class="w-4 h-4"></i>
                        </button>
                    </div>
                 </div>
                 <div id="search-results-container" class="flex-1 overflow-y-auto p-4 min-h-0">
                    <!-- Search results will be injected here -->
                    <div class="text-center text-gray-500 dark:text-gray-400 mt-8">
                        <i data-lucide="folder-search" class="w-16 h-16 mx-auto mb-4 text-primary-400"></i>
                        <h3 data-i18n="repoSearchInitialTitle" class="text-lg font-medium mb-2">Repository Search</h3>
                        <p data-i18n="repoSearchInitialMessage" class="text-sm">Results from your chat will appear here.</p>
                    </div>
                 </div>
            </section>
        </main>
    </div>

    <!-- Notification Container -->
    <div id="notification-container"></div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- DOM Element Selectors ---
    const getEl = (id) => document.getElementById(id);
    const appContainer = getEl('app-container');
    const panelContainer = getEl('panel-container');
    const notificationContainer = getEl('notification-container');

    // --- Utility Functions ---
    // Debounce function (moved to top for scope)
    const debounce = (func, delay) => { let timeout; return (...args) => { clearTimeout(timeout); timeout = setTimeout(() => func.apply(this, args), delay); }; };
    const formatNumber = (num) => num > 999 ? `${(num / 1000).toFixed(1)}k` : num;

    // --- State Management ---
    let state = {
        theme: localStorage.getItem('theme') || 'light',
        isSearchVisible: false,
        isNavOpen: false,
        isTyping: false,
        messages: JSON.parse(localStorage.getItem('chatMessages')) || [],
        searchHistory: JSON.parse(localStorage.getItem('searchHistory')) || [],
        activeView: 'chat', // Default to 'chat' for initial display
        isResizing: null,
        navWidth: parseInt(localStorage.getItem('navWidth')) || 240,
        searchWidth: parseInt(localStorage.getItem('searchWidth')) || 400,
        isVersionDropdownOpen: false,
        selectedVersionId: localStorage.getItem('selectedVersionId') || 'v1',
        versions: [
            { id: 'v3', name: 'SEFGH v3.0', description: 'Advanced model with contextual understanding.', persona: "Got it. " },
            { id: 'v2', name: 'SEFGH v2.0', description: 'Stable model for reliable keyword searches.', persona: "Okay, " },
            { id: 'v1', name: 'SEFGH v1.0', description: 'Legacy model for direct search term matching.', persona: "Searching: " }
        ],
        editingMessageId: null,
        isLoggedIn: false,
        selectedLanguage: localStorage.getItem('selectedLanguage') || 'en', // NEW: Default language
        consoleLogs: [], // NEW: Array to store console logs
    };
    
    // --- Get all DOM elements ---
    const [
        htmlEl,
        toggleSearchBtn,
        toggleNavBtn,
        chatPanel,
        searchPanel,
        navPanel,
        historyPanel, // Renamed from search-history-panel
        languagePanel, // NEW
        settingsPanel, // NEW
        consolePanel, // NEW
        docsPanel, // NEW
        playgroundPanel, // NEW
        proxyPanel, // NEW
        allPagesPanel, // NEW
        navResizeHandle,
        searchResizeHandle,
        messagesContainer,
        chatForm,
        chatTextarea,
        sendBtn,
        clearChatHistoryBtn, // Renamed from clear-history-btn for clarity
        searchInput,
        searchResultsContainer,
        historyContainer,
        clearSearchHistoryBtn,
        versionToggleBtn,
        versionMenu,
        versionName,
        versionChevron,
        closeSearchPanelBtn,
        userAccountBtn,
        navItemsContainer, // NEW
        mainContentWrapper, // NEW
        clearSearchInputBtn, // NEW
        consoleOutput, // NEW
        copyLogBtn, // NEW
        downloadLogBtn, // NEW
        // NEW MOBILE ELEMENTS
        mainHeaderLogo, // The logo in the main header
        mainHeaderGithubBtn, // GitHub button in main header
        mainHeaderThemeToggleBtn, // Theme toggle in main header
        mobileNavHeader, // The new header div inside nav-panel
        mobileNavGithubBtn, // GitHub button inside mobile nav header
        mobileNavThemeToggleBtn, // Theme toggle inside mobile nav header
    ] = [
        document.documentElement,
        getEl('toggle-search-btn'),
        getEl('toggle-nav-btn'),
        getEl('chat-panel'),
        getEl('search-panel'),
        getEl('nav-panel'),
        getEl('history-panel'),
        getEl('language-panel'),
        getEl('settings-panel'),
        getEl('console-panel'),
        getEl('docs-panel'),
        getEl('playground-panel'),
        getEl('proxy-panel'), // NEW
        getEl('all-pages-panel'), // NEW
        getEl('nav-resize-handle'),
        getEl('search-resize-handle'),
        getEl('messages-container'),
        getEl('chat-form'),
        getEl('chat-textarea'),
        getEl('send-btn'),
        getEl('clear-history-btn'), // Still using this ID from HTML
        getEl('search-input'),
        getEl('search-results-container'),
        getEl('history-container'),
        getEl('clear-search-history-btn'),
        getEl('version-toggle-btn'),
        getEl('version-menu'),
        getEl('version-name'),
        getEl('version-chevron'),
        getEl('close-search-panel-btn'),
        getEl('user-account-btn'),
        getEl('nav-items-container'),
        getEl('main-content-wrapper'),
        getEl('clear-search-input-btn'), // NEW
        getEl('console-output'), // NEW
        getEl('copy-log-btn'), // NEW
        getEl('download-log-btn'), // NEW
        // NEW MOBILE ELEMENTS
        getEl('main-header-logo'), // Select the logo in the header by ID
        getEl('main-header-github-btn'), // Select GitHub button in header by ID
        getEl('theme-toggle-btn'), // Still using this ID for the main header theme toggle
        getEl('mobile-nav-header'),
        getEl('mobile-nav-github-btn'),
        getEl('mobile-nav-theme-toggle-btn'),
    ];
    
    // Map data-view names to actual panel elements
    const contentPanels = {
        'chat': chatPanel,
        'chat-history': historyPanel, // 'chat-history' maps to the historyPanel
        'language': languagePanel,
        'settings': settingsPanel,
        'console': consolePanel,
        'docs': docsPanel,
        'playground': playgroundPanel,
        'proxy': proxyPanel, // NEW
        'all-pages': allPagesPanel, // NEW
        // 'search' is handled separately as it's a side panel
    };

    // --- Translations Object (NEW) ---
    const translations = {
        en: {
            pageTitle: "SEFGH - AI-Powered GitHub Repository Search",
            navigationTitle: "Navigation",
            newChat: "New Chat",
            chatHistory: "Chat History",
            docs: "Docs",
            playground: "Playground",
            console: "Console",
            proxy: "Proxy",
            language: "Language",
            settings: "Settings",
            allPages: "All Pages", // NEW
            allPagesTitle: "All Pages", // NEW
            allPagesDescription: "Explore all available sections of the SEFGH application.", // NEW
            chatPlaceholder: "e.g., 'Find a lightweight charting library for React'",
            disclaimer: "SEFGH-Ai is evolving. Confirm essential information",
            chatHistoryTitle: "Chat History",
            noChatHistory: "No Chat History",
            welcomeTitle: "Welcome to SEFGH!", // Added for clarity
            welcomeMessage: "How can I help you explore GitHub today?", // Added for clarity
            chatHistoryEmptyMessage: "Your past conversations will appear here.",
            proxySettingsTitle: "Proxy Settings",
            proxyDescription: "Configure your proxy settings here.",
            proxyAddressLabel: "Proxy Address",
            proxyUsernameLabel: "Username (Optional)",
            proxyPasswordLabel: "Password (Optional)",
            saveProxySettingsBtn: "Save Proxy Settings",
            languageSettingsTitle: "Language Settings",
            languageDescription: "Select your preferred language for the application interface:",
            settingsTitle: "Settings",
            settingsDescription: "Application settings will be configured here.",
            consoleTitle: "Console",
            consoleDescription: "Developer console output will appear here.",
            copyLogBtn: "Copy Log", // NEW
            downloadLogBtn: "Download Log", // NEW
            logCopied: "Console log copied to clipboard!", // NEW
            logDownloaded: "Console log downloaded!", // NEW
            docsTitle: "Documentation",
            docsDescription: "Documentation for SEFGH will be displayed here.",
            playgroundTitle: "Playground",
            playgroundDescription: "Experiment with SEFGH features in this playground.",
            repoSearchTitle: "Repo Search",
            searchPlaceholder: "Search GitHub repositories...",
            repoSearchInitialTitle: "Repository Search",
            repoSearchInitialMessage: "Results from your chat will appear here.",
            noResultsFoundTitle: "No Results Found",
            noResultsFoundMessage: (query) => `Your search for "${query}" did not match any repositories.`,
            anErrorOccurred: "An Error Occurred",
            apiErrorMessage: (message) => `${message}`,
            llmApiFailed: "My apologies, I'm having trouble connecting to my core intelligence right now. Please check your internet connection or try again in a moment.",
            messageCopied: "Message copied to clipboard!",
            messageDeleted: "Message deleted.",
            switchedToVersion: (versionName) => `Switched to ${versionName}.`,
            aiInitiatedSearch: (query) => `AI initiated search for: "${query}"`,
        },
        es: {
            pageTitle: "SEFGH - Búsqueda de Repositorios GitHub con IA",
            navigationTitle: "Navegación",
            newChat: "Nuevo Chat",
            chatHistory: "Historial de Chat",
            docs: "Documentos",
            playground: "Patio de Juegos",
            console: "Consola",
            proxy: "Proxy",
            language: "Idioma",
            settings: "Ajustes",
            allPages: "Todas las Páginas", // NEW
            allPagesTitle: "Todas las Páginas", // NEW
            allPagesDescription: "Explore todas las secciones disponibles de la aplicación SEFGH.", // NEW
            chatPlaceholder: "Ej: 'Encontrar una librería de gráficos ligera para React'",
            disclaimer: "SEFGH-Ai está evolucionando. Confirme la información esencial",
            chatHistoryTitle: "Historial de Chat",
            noChatHistory: "No hay Historial de Chat",
            welcomeTitle: "¡Bienvenido a SEFGH!",
            welcomeMessage: "¿Cómo puedo ayudarte a explorar GitHub hoy?",
            chatHistoryEmptyMessage: "Tus conversaciones anteriores aparecerán aquí.",
            proxySettingsTitle: "Configuración de Proxy",
            proxyDescription: "Configure aquí la configuración de su proxy.",
            proxyAddressLabel: "Dirección del Proxy",
            proxyUsernameLabel: "Nombre de Usuario (Opcional)",
            proxyPasswordLabel: "Contraseña (Opcional)",
            saveProxySettingsBtn: "Guardar Configuración de Proxy",
            languageSettingsTitle: "Configuración de Idioma",
            languageDescription: "Seleccione su idioma preferido para la interfaz de la aplicación:",
            settingsTitle: "Ajustes",
            settingsDescription: "La configuración de la aplicación se configurará aquí.",
            consoleTitle: "Consola",
            consoleDescription: "La salida de la consola de desarrollador aparecerá aquí.",
            copyLogBtn: "Copiar Registro",
            downloadLogBtn: "Descargar Registro",
            logCopied: "Registro de consola copiado al portapapeles!",
            logDownloaded: "Registro de consola descargado!",
            docsTitle: "Documentación",
            docsDescription: "La documentación de SEFGH se mostrará aquí.",
            playgroundTitle: "Patio de Juegos",
            playgroundDescription: "Experimente con las funciones de SEFGH en este patio de juegos.",
            repoSearchTitle: "Búsqueda de Repositorios",
            searchPlaceholder: "Buscar repositorios de GitHub...",
            repoSearchInitialTitle: "Búsqueda de Repositorios",
            repoSearchInitialMessage: "Los resultados de tu chat aparecerán aquí.",
            noResultsFoundTitle: "No se Encontraron Resultados",
            noResultsFoundMessage: (query) => `Tu búsqueda de "${query}" no coincidió con ningún repositorio.`,
            anErrorOccurred: "Ha Ocurrido un Error",
            apiErrorMessage: (message) => `${message}`,
            llmApiFailed: "Disculpe, estoy teniendo problemas para conectarme a mi inteligencia central en este momento. Por favor, verifique su conexión a internet o intente de nuevo en un momento.",
            messageCopied: "Mensaje copiado al portapapeles!",
            messageDeleted: "Mensaje eliminado.",
            switchedToVersion: (versionName) => `Cambiado a ${versionName}.`,
            aiInitiatedSearch: (query) => `Búsqueda iniciada por IA para: "${query}"`,
        },
        fr: {
            pageTitle: "SEFGH - Recherche de Dépôts GitHub Alimentée par l'IA",
            navigationTitle: "Navigation",
            newChat: "Nouveau Chat",
            chatHistory: "Historique du Chat",
            docs: "Docs",
            playground: "Aire de Jeux",
            console: "Console",
            proxy: "Proxy",
            language: "Langue",
            settings: "Paramètres",
            allPages: "Toutes les Pages", // NEW
            allPagesTitle: "Toutes les Pages", // NEW
            allPagesDescription: "Explorez toutes les sections disponibles de l'application SEFGH.", // NEW
            chatPlaceholder: "Ex: 'Trouver une bibliothèque de graphiques légère pour React'",
            disclaimer: "SEFGH-Ai évolue. Confirmez les informations essentielles",
            chatHistoryTitle: "Historique du Chat",
            noChatHistory: "Aucun Historique de Chat",
            welcomeTitle: "Bienvenue sur SEFGH !",
            welcomeMessage: "Comment puis-je vous aider à explorer GitHub aujourd'hui ?",
            proxySettingsTitle: "Paramètres Proxy",
            proxyDescription: "Configurez vos paramètres proxy ici.",
            proxyAddressLabel: "Adresse Proxy",
            proxyUsernameLabel: "Nom d'utilisateur (Facultatif)",
            proxyPasswordLabel: "Mot de passe (Facultatif)",
            saveProxySettingsBtn: "Enregistrer les Paramètres Proxy",
            languageSettingsTitle: "Paramètres de Langue",
            languageDescription: "Sélectionnez votre langue préférée pour l'interface de l'application :",
            settingsTitle: "Paramètres",
            settingsDescription: "Les paramètres de l'application seront configurés ici.",
            consoleTitle: "Console",
            consoleDescription: "La sortie de la console développeur apparaîtra ici.",
            copyLogBtn: "Copier le journal",
            downloadLogBtn: "Télécharger le journal",
            logCopied: "Journal de la console copié dans le presse-papiers !",
            logDownloaded: "Journal de la console téléchargé !",
            docsTitle: "Documentation",
            docsDescription: "La documentation de SEFGH sera affichée ici.",
            playgroundTitle: "Aire de Jeux",
            playgroundDescription: "Expérimentez les fonctionnalités de SEFGH dans cette aire de jeux.",
            repoSearchTitle: "Recherche de Dépôts",
            searchPlaceholder: "Rechercher des dépôts GitHub...",
            repoSearchInitialTitle: "Recherche de Dépôts",
            repoSearchInitialMessage: "Les résultats de votre chat apparaîtront ici.",
            noResultsFoundTitle: "Aucun Résultat Trouvé",
            noResultsFoundMessage: (query) => `Votre recherche pour "${query}" n'a donné aucun dépôt.`,
            anErrorOccurred: "Une Erreur est Survenue",
            apiErrorMessage: (message) => `${message}`,
            llmApiFailed: "Mes excuses, je rencontre des difficultés pour me connecter à mon intelligence centrale en ce moment. Veuillez vérifier votre connexion internet ou réessayer dans un instant.",
            messageCopied: "Message copié dans le presse-papiers !",
            messageDeleted: "Message supprimé.",
            switchedToVersion: (versionName) => `Passé à ${versionName}.`,
            aiInitiatedSearch: (query) => `Recherche initiée par l'IA pour : "${query}"`,
        },
        de: {
            pageTitle: "SEFGH - KI-gestützte GitHub-Repository-Suche",
            navigationTitle: "Navigation",
            newChat: "Neuer Chat",
            chatHistory: "Chat-Verlauf",
            docs: "Dokumente",
            playground: "Spielplatz",
            console: "Konsole",
            proxy: "Proxy",
            language: "Sprache",
            settings: "Einstellungen",
            allPages: "Alle Seiten", // NEW
            allPagesTitle: "Alle Seiten", // NEW
            allPagesDescription: "Erkunden Sie alle verfügbaren Bereiche der SEFGH-Anwendung.", // NEW
            chatPlaceholder: "Z.B. 'Eine leichte Diagrammbibliothek für React finden'",
            disclaimer: "SEFGH-Ai entwickelt sich weiter. Bestätigen Sie wesentliche Informationen",
            chatHistoryTitle: "Chat-Verlauf",
            noChatHistory: "Kein Chat-Verlauf",
            welcomeTitle: "Willkommen bei SEFGH!",
            welcomeMessage: "Wie kann ich Ihnen heute bei der Erkundung von GitHub helfen?",
            proxySettingsTitle: "Proxy-Einstellungen",
            proxyDescription: "Konfigurieren Sie hier Ihre Proxy-Einstellungen.",
            proxyAddressLabel: "Proxy-Adresse",
            proxyUsernameLabel: "Benutzername (Optional)",
            proxyPasswordLabel: "Passwort (Optional)",
            saveProxySettingsBtn: "Proxy-Einstellungen speichern",
            languageSettingsTitle: "Spracheinstellungen",
            languageDescription: "Wählen Sie Ihre bevorzugte Sprache für die Anwendungsoberfläche:",
            settingsTitle: "Einstellungen",
            settingsDescription: "Anwendungseinstellungen werden hier konfiguriert.",
            consoleTitle: "Konsole",
            consoleDescription: "Die Konsolenausgabe des Entwicklers wird hier angezeigt.",
            copyLogBtn: "Protokoll kopieren",
            downloadLogBtn: "Protokoll herunterladen",
            logCopied: "Konsolenprotokoll in die Zwischenablage kopiert!",
            logDownloaded: "Konsolenprotokoll heruntergeladen!",
            docsTitle: "Dokumentation",
            docsDescription: "Die Dokumentation für SEFGH wird hier angezeigt.",
            playgroundTitle: "Spielplatz",
            playgroundDescription: "Experimentieren Sie mit SEFGH-Funktionen auf diesem Spielplatz.",
            repoSearchTitle: "Repo-Suche",
            searchPlaceholder: "GitHub-Repositories durchsuchen...",
            repoSearchInitialTitle: "Repository-Suche",
            repoSearchInitialMessage: "Ergebnisse aus Ihrem Chat werden hier angezeigt.",
            noResultsFoundTitle: "Keine Ergebnisse gefunden",
            noResultsFoundMessage: (query) => `Ihre Suche nach „${query}“ ergab keine Übereinstimmungen mit Repositorys.`,
            anErrorOccurred: "Ein Fehler ist aufgetreten",
            apiErrorMessage: (message) => `${message}`,
            llmApiFailed: "Entschuldigen Sie, ich habe derzeit Probleme, mich mit meiner Kernintelligenz zu verbinden. Bitte überprüfen Sie Ihre Internetverbindung oder versuchen Sie es in einem Moment erneut.",
            messageCopied: "Nachricht in die Zwischenablage kopiert!",
            messageDeleted: "Nachricht gelöscht.",
            switchedToVersion: (versionName) => `Gewechselt zu ${versionName}.`,
            aiInitiatedSearch: (query) => `KI-initiierte Suche nach: „${query}“`,
        },
        ja: {
            pageTitle: "SEFGH - AI搭載GitHubリポジトリ検索",
            navigationTitle: "ナビゲーション",
            newChat: "新しいチャット",
            chatHistory: "チャット履歴",
            docs: "ドキュメント",
            playground: "プレイグラウンド",
            console: "コンソール",
            proxy: "プロキシ",
            language: "言語",
            settings: "設定",
            allPages: "すべてのページ", // NEW
            allPagesTitle: "すべてのページ", // NEW
            allPagesDescription: "SEFGHアプリケーションの利用可能なすべてのセクションを探索します。", // NEW
            chatPlaceholder: "例: 'React用の軽量チャートライブラリを見つける'",
            disclaimer: "SEFGH-Aiは進化しています。重要な情報を確認してください",
            chatHistoryTitle: "チャット履歴",
            noChatHistory: "チャット履歴なし",
            welcomeTitle: "SEFGHへようこそ！",
            welcomeMessage: "GitHubの探索をどのようにサポートできますか？",
            proxySettingsTitle: "プロキシ設定",
            proxyDescription: "ここでプロキシ設定を構成します。",
            proxyAddressLabel: "プロキシアドレス",
            proxyUsernameLabel: "ユーザー名 (オプション)",
            proxyPasswordLabel: "パスワード (オプション)",
            saveProxySettingsBtn: "プロキシ設定を保存",
            languageSettingsTitle: "言語設定",
            languageDescription: "アプリケーションインターフェースの優先言語を選択してください:",
            settingsTitle: "設定",
            settingsDescription: "アプリケーション設定はここで構成されます。",
            consoleTitle: "コンソール",
            consoleDescription: "開発者コンソール出力がここに表示されます。",
            copyLogBtn: "ログをコピー",
            downloadLogBtn: "ログをダウンロード",
            logCopied: "コンソールログがクリップボードにコピーされました！",
            logDownloaded: "コンソールログがダウンロードされました！",
            docsTitle: "ドキュメント",
            docsDescription: "SEFGHのドキュメントがここに表示されます。",
            playgroundTitle: "プレイグラウンド",
            playgroundDescription: "このプレイグラウンドでSEFGHの機能を試してください。",
            repoSearchTitle: "リポジトリ検索",
            searchPlaceholder: "GitHubリポジトリを検索...",
            repoSearchInitialTitle: "リポジトリ検索",
            repoSearchInitialMessage: "チャットからの結果がここに表示されます。",
            noResultsFoundTitle: "結果が見つかりません",
            noResultsFoundMessage: (query) => `「${query}」の検索では、リポジトリが見つかりませんでした。`,
            anErrorOccurred: "エラーが発生しました",
            apiErrorMessage: (message) => `${message}`,
            llmApiFailed: "申し訳ありません、現在、私の中心的な知能に接続するのに問題があります。インターネット接続を確認するか、しばらくしてからもう一度お試しください。",
            messageCopied: "メッセージがクリップボードにコピーされました！",
            messageDeleted: "メッセージが削除されました。",
            switchedToVersion: (versionName) => `${versionName}に切り替えました。`,
            aiInitiatedSearch: (query) => `AIが検索を開始しました: 「${query}」`,
        },
        zh: {
            pageTitle: "SEFGH - AI驱动的GitHub仓库搜索",
            navigationTitle: "导航",
            newChat: "新聊天",
            chatHistory: "聊天历史",
            docs: "文档",
            playground: "游乐场",
            console: "控制台",
            proxy: "代理",
            language: "语言",
            settings: "设置",
            allPages: "所有页面", // NEW
            allPagesTitle: "所有页面", // NEW
            allPagesDescription: "探索SEFGH应用程序的所有可用部分。", // NEW
            chatPlaceholder: "例如：'查找一个轻量级的React图表库'",
            disclaimer: "SEFGH-Ai正在发展中。请确认重要信息",
            chatHistoryTitle: "聊天历史",
            noChatHistory: "无聊天历史",
            welcomeTitle: "欢迎使用SEFGH！",
            welcomeMessage: "我今天能如何帮助您探索GitHub？",
            proxySettingsTitle: "代理设置",
            proxyDescription: "在此处配置您的代理设置。",
            proxyAddressLabel: "代理地址",
            proxyUsernameLabel: "用户名（可选）",
            proxyPasswordLabel: "密码（可选）",
            saveProxySettingsBtn: "保存代理设置",
            languageSettingsTitle: "语言设置",
            languageDescription: "请选择您偏好的应用程序界面语言：",
            settingsTitle: "设置",
            settingsDescription: "应用程序设置将在此处配置。",
            consoleTitle: "控制台",
            consoleDescription: "开发者控制台输出将显示在此处。",
            copyLogBtn: "复制日志",
            downloadLogBtn: "下载日志",
            logCopied: "控制台日志已复制到剪贴板！",
            logDownloaded: "控制台日志已下载！",
            docsTitle: "文档",
            docsDescription: "SEFGH的文档将显示在此处。",
            playgroundTitle: "游乐场",
            playgroundDescription: "在此游乐场中体验SEFGH的功能。",
            repoSearchTitle: "仓库搜索",
            searchPlaceholder: "搜索GitHub仓库...",
            repoSearchInitialTitle: "仓库搜索",
            repoSearchInitialMessage: "您的聊天结果将显示在此处。",
            noResultsFoundTitle: "未找到结果",
            noResultsFoundMessage: (query) => `您对“${query}”的搜索未匹配到任何仓库。`,
            anErrorOccurred: "发生错误",
            apiErrorMessage: (message) => `${message}`,
            llmApiFailed: "非常抱歉，我目前无法连接到我的核心智能。请检查您的互联网连接或稍后再试。",
            messageCopied: "消息已复制到剪贴板！",
            messageDeleted: "消息已删除。",
            switchedToVersion: (versionName) => `已切换到 ${versionName}。`,
            aiInitiatedSearch: (query) => `AI发起了搜索："${query}"`,
        },
        hi: {
            pageTitle: "SEFGH - एआई-पावर्ड गिटहब रिपॉजिटरी खोज",
            navigationTitle: "नेविगेशन",
            newChat: "नई चैट",
            chatHistory: "चैट इतिहास",
            docs: "दस्तावेज़",
            playground: "प्लेग्राउंड",
            console: "कंसोल",
            proxy: "प्रॉक्सी",
            language: "भाषा",
            settings: "सेटिंग्स",
            allPages: "सभी पेज", // NEW
            allPagesTitle: "सभी पेज", // NEW
            allPagesDescription: "SEFGH एप्लिकेशन के सभी उपलब्ध अनुभागों का अन्वेषण करें।", // NEW
            chatPlaceholder: "उदाहरन: 'रिएक्ट के लिए एक हल्की चार्टिंग लाइब्रेरी खोजें'",
            disclaimer: "SEFGH-Ai विकसित हो रहा है। आवश्यक जानकारी की पुष्टि करें",
            chatHistoryTitle: "चैट इतिहास",
            noChatHistory: "कोई चैट इतिहास नहीं",
            welcomeTitle: "SEFGH में आपका स्वागत है!",
            welcomeMessage: "मैं आज आपको GitHub का अन्वेषण करने में कैसे मदद कर सकता हूँ?",
            proxySettingsTitle: "प्रॉक्सी सेटिंग्स",
            proxyDescription: "अपनी प्रॉक्सी सेटिंग्स यहां कॉन्फ़िगर करें।",
            proxyAddressLabel: "प्रॉक्सी पता",
            proxyUsernameLabel: "उपयोगकर्ता नाम (वैकल्पिक)",
            proxyPasswordLabel: "पासवर्ड (वैकल्पिक)",
            saveProxySettingsBtn: "प्रॉक्सी सेटिंग्स सहेजें",
            languageSettingsTitle: "भाषा सेटिंग्स",
            languageDescription: "एप्लिकेशन इंटरफ़ेस के लिए अपनी पसंदीदा भाषा चुनें:",
            settingsTitle: "सेटिंग्स",
            settingsDescription: "एप्लिकेशन सेटिंग्स यहां कॉन्फ़िगर की जाएंगी।",
            consoleTitle: "कंसोल",
            consoleDescription: "डेवलपर कंसोल आउटपुट यहां दिखाई देगा।",
            copyLogBtn: "लॉग कॉपी करें",
            downloadLogBtn: "लॉग डाउनलोड करें",
            logCopied: "कंसोल लॉग क्लिपबोर्ड पर कॉपी किया गया!",
            logDownloaded: "कंसोल लॉग डाउनलोड किया गया!",
            docsTitle: "दस्तावेज़",
            docsDescription: "SEFGH के लिए दस्तावेज़ यहां प्रदर्शित किए जाएंगे।",
            playgroundTitle: "प्लेग्राउंड",
            playgroundDescription: "इस प्लेग्राउंड में SEFGH सुविधाओं के साथ प्रयोग करें।",
            repoSearchTitle: "रेपो खोज",
            searchPlaceholder: "गिटहब रिपॉजिटरी खोजें...",
            repoSearchInitialTitle: "रिपॉजिटरी खोज",
            repoSearchInitialMessage: "आपके चैट के परिणाम यहां दिखाई देंगे।",
            noResultsFoundTitle: "कोई परिणाम नहीं मिला",
            noResultsFoundMessage: (query) => `आपके "${query}" की खोज किसी भी रिपॉजिटरी से मेल नहीं खाती।`,
            anErrorOccurred: "एक त्रुटि हुई",
            apiErrorMessage: (message) => `${message}`,
            llmApiFailed: "मुझे खेद है, मुझे इस समय अपनी मुख्य बुद्धिमत्ता से जुड़ने में समस्या हो रही है। कृपया अपना इंटरनेट कनेक्शन जांचें या थोड़ी देर बाद पुनः प्रयास करें।",
            messageCopied: "संदेश क्लिपबोर्ड पर कॉपी किया गया!",
            messageDeleted: "संदेश हटा दिया गया।",
            switchedToVersion: (versionName) => `${versionName} पर स्विच किया गया।`,
            aiInitiatedSearch: (query) => `एआई द्वारा शुरू की गई खोज: "${query}"`,
        },
        te: {
            pageTitle: "SEFGH - AI-శక్తివంతమైన GitHub రిపోజిటరీ శోధన",
            navigationTitle: "నావిగేషన్",
            newChat: "కొత్త చాట్",
            chatHistory: "చాట్ చరిత్ర",
            docs: "డాక్స్",
            playground: "ప్లేగ్రౌండ్",
            console: "కన్సోల్",
            proxy: "ప్రాక్సీ",
            language: "భాష",
            settings: "సెట్టింగ్‌లు",
            allPages: "అన్ని పేజీలు", // NEW
            allPagesTitle: "అన్ని పేజీలు", // NEW
            allPagesDescription: "SEFGH అప్లికేషన్ యొక్క అన్ని అందుబాటులో ఉన్న విభాగాలను అన్వేషించండి.", // NEW
            chatPlaceholder: "ఉదా: 'రియాక్ట్ కోసం తేలికపాటి చార్టింగ్ లైబ్రరీని కనుగొనండి'",
            disclaimer: "SEFGH-Ai అభివృద్ధి చెందుతోంది. అవసరమైన సమాచారాన్ని నిర్ధారించండి",
            chatHistoryTitle: "చాట్ చరిత్ర",
            noChatHistory: "చాట్ చరిత్ర లేదు",
            welcomeTitle: "SEFGH కు స్వాగతం!",
            welcomeMessage: "ఈ రోజు GitHub ను అన్వేషించడానికి నేను మీకు ఎలా సహాయపడగలను?",
            proxySettingsTitle: "ప్రాక్సీ సెట్టింగ్‌లు",
            proxyDescription: "మీ ప్రాక్సీ సెట్టింగ్‌లను ఇక్కడ కాన్ఫిగర్ చేయండి.",
            proxyAddressLabel: "ప్రాక్సీ చిరునామా",
            proxyUsernameLabel: "వినియోగదారు పేరు (ఐచ్ఛికం)",
            proxyPasswordLabel: "పాస్‌వర్డ్ (ఐచ్ఛికం)",
            saveProxySettingsBtn: "ప్రాక్సీ సెట్టింగ్‌లను సేవ్ చేయండి",
            languageSettingsTitle: "భాషా సెట్టింగ్‌లు",
            languageDescription: "అప్లికేషన్ ఇంటర్‌ఫేస్ కోసం మీకు ఇష్టమైన భాషను ఎంచుకోండి:",
            settingsTitle: "సెట్టింగ్‌లు",
            settingsDescription: "అప్లికేషన్ సెట్టింగ్‌లు ఇక్కడ కాన్ఫిగర్ చేయబడతాయి.",
            consoleTitle: "కన్సోల్",
            consoleDescription: "డెవలపర్ కన్సోల్ అవుట్‌పుట్ ఇక్కడ కనిపిస్తుంది.",
            copyLogBtn: "లాగ్ కాపీ చేయండి",
            downloadLogBtn: "లాగ్ డౌన్‌లోడ్ చేయండి",
            logCopied: "కన్సోల్ లాగ్ క్లిప్‌బోర్డ్‌కు కాపీ చేయబడింది!",
            logDownloaded: "కన్సోల్ లాగ్ డౌన్‌లోడ్ చేయబడింది!",
            docsTitle: "డాక్యుమెంటేషన్",
            docsDescription: "SEFGH కోసం డాక్యుమెంటేషన్ ఇక్కడ ప్రదర్శించబడుతుంది.",
            playgroundTitle: "ప్లేగ్రౌండ్",
            playgroundDescription: "ఈ ప్లేగ్రౌండ్‌లో SEFGH ఫీచర్‌లతో ప్రయోగాలు చేయండి.",
            repoSearchTitle: "రెపో శోధన",
            searchPlaceholder: "GitHub రిపోజిటరీలను శోధించండి...",
            repoSearchInitialTitle: "రిపోజిటరీ శోధన",
            repoSearchInitialMessage: "మీ చాట్ నుండి ఫలితాలు ఇక్కడ కనిపిస్తాయి.",
            noResultsFoundTitle: "ఫలితాలు కనుగొనబడలేదు",
            noResultsFoundMessage: (query) => `మీరు శోధించిన "${query}"కు ఏ రిపోజిటరీలు సరిపోలలేదు.`,
            anErrorOccurred: "ఒక లోపం సంభవించింది",
            apiErrorMessage: (message) => `${message}`,
            llmApiFailed: "క్షమించండి, నా ప్రధాన ఇంటెలిజెన్స్‌కు కనెక్ట్ చేయడంలో నాకు ప్రస్తుతం సమస్య ఉంది. దయచేసి మీ ఇంటర్నెట్ కనెక్షన్‌ని తనిఖీ చేయండి లేదా కొద్దిసేపటి తర్వాత మళ్లీ ప్రయత్నించండి।",
            messageCopied: "సందేశం క్లిప్‌బోర్డ్‌కు కాపీ చేయబడింది!",
            messageDeleted: "సందేశం తొలగించబడింది.",
            switchedToVersion: (versionName) => `${versionName}కు మార్చబడింది.`,
            aiInitiatedSearch: (query) => `AI ద్వారా శోధన ప్రారంభించబడింది: "${query}"`,
        }
    };

    /**
     * Displays a notification message.
     * @param {string} message The message to display.
     * @param {'info'|'success'|'error'} type The type of notification.
     * @param {number} duration The duration in milliseconds before the notification fades out.
     */
    const showNotification = (message, type = 'info', duration = 7000) => { 
        const notificationItem = document.createElement('div');
        notificationItem.className = `notification-item ${type}`;
        notificationItem.innerHTML = `
            <span>${message}</span>
            <button class="ml-4 text-white opacity-75 hover:opacity-100" onclick="this.closest('.notification-item').remove()">
                <i data-lucide="x" class="w-4 h-4"></i>
            </button>
        `;
        notificationContainer.appendChild(notificationItem);
        lucide.createIcons(); 

        setTimeout(() => {
            notificationItem.style.opacity = '0';
            notificationItem.style.transform = 'translateY(-20px)';
            setTimeout(() => notificationItem.remove(), 500); 
        }, duration);
    };

    /**
     * Converts a Markdown string to HTML using marked.js.
     * @param {string} markdownText The input string with Markdown.
     * @returns {string} The HTML formatted string.
     */
    const parseMarkdownToHtml = (markdownText) => {
        if (typeof markdownText !== 'string') {
            console.error("parseMarkdownToHtml: Received non-string input:", markdownText, "Type:", typeof markdownText);
            // Attempt to convert to string as a fallback, but log the error
            markdownText = String(markdownText);
        }

        const renderer = new marked.Renderer();

        renderer.heading = (text, level) => {
            const tag = `h${level}`;
            let classes = '';
            if (level === 1) classes = 'text-xl font-bold mt-4 mb-2';
            else if (level === 2) classes = 'text-lg font-semibold mt-3 mb-1.5';
            else if (level === 3) classes = 'text-base font-medium mt-2.5 mb-1';
            return `<${tag} class="${classes}">${text}</${tag}>`;
        };

        renderer.paragraph = (text) => {
            return `<p class="mb-2 last:mb-0">${text}</p>`;
        };

        renderer.listitem = (text) => {
            return `<li class="ml-4 list-disc">${text}</li>`; 
        };
        
        renderer.code = (code, language) => {
            return `<pre class="bg-gray-800 text-gray-200 p-3 rounded-md overflow-x-auto my-2 text-sm font-mono"><code class="language-${language}">${code}</code></pre>`;
        };

        renderer.codespan = (code) => {
            return `<code class="bg-gray-200 dark:bg-gray-700 rounded px-1 py-0.5 text-sm font-mono">${code}</code>`;
        };

        renderer.link = (href, title, text) => {
            return `<a href="${href}" target="_blank" rel="noopener noreferrer" class="text-primary-600 dark:text-primary-400 hover:underline">${text}</a>`;
        };

        marked.setOptions({
            renderer: renderer,
            gfm: true, 
            breaks: true, 
            sanitize: true 
        });

        return marked.parse(markdownText);
    };

    // --- Language Selection Logic (NEW) ---
    const setLanguage = (langCode) => {
        console.log(`setLanguage: Setting language to ${langCode}`);
        state.selectedLanguage = langCode;
        localStorage.setItem('selectedLanguage', langCode);

        // Update all elements with data-i18n attribute
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            let translation = translations[langCode][key];

            // Handle functions for dynamic messages (e.g., noResultsFoundMessage)
            if (typeof translation === 'function') {
                // For now, we'll only apply it where we know the context (e.g., renderSearchEmpty).
                // For static elements, it's just the string.
                element.textContent = translations['en'][key]; // Fallback to English for static if function
            } else {
                element.textContent = translation;
            }
        });

        // Update active state for language buttons
        document.querySelectorAll('.lang-select-btn').forEach(button => {
            if (button.dataset.lang === langCode) {
                button.classList.add('bg-primary-100', 'dark:bg-primary-800', 'text-primary-800', 'dark:text-primary-100', 'font-medium');
                button.classList.remove('hover:bg-gray-200', 'dark:hover:bg-gray-700/80');
                button.querySelector('.lang-check-icon').innerHTML = `<i data-lucide="check-circle" class="w-5 h-5 text-green-500"></i>`;
            } else {
                button.classList.remove('bg-primary-100', 'dark:bg-primary-800', 'text-primary-800', 'dark:text-primary-100', 'font-medium');
                button.classList.add('hover:bg-gray-200', 'dark:hover:bg-gray-700/80');
                button.querySelector('.lang-check-icon').innerHTML = `<i data-lucide="circle" class="w-5 h-5 text-gray-400"></i>`;
            }
        });
        
        lucide.createIcons(); // Re-render Lucide icons for check/circle
    };


    // --- View & UI Logic ---
    const setActiveView = (view) => {
        console.log(`setActiveView: Switching to view: ${view}. Nav Open: ${state.isNavOpen}, Search Visible: ${state.isSearchVisible}`);
        const isMobile = window.innerWidth < 768;

        // Reset visibility for all panels and handles
        navPanel.classList.add('hidden');
        navResizeHandle.classList.add('hidden');
        searchPanel.classList.add('hidden');
        searchResizeHandle.classList.add('hidden');
        
        // Hide mobile nav header by default
        mobileNavHeader.classList.add('hidden');

        // Hide all main content panels
        Object.values(contentPanels).forEach(panel => panel.classList.add('hidden'));

        // Remove mobile overlay styles from search panel
        searchPanel.classList.remove('absolute', 'inset-0', 'z-20');
        closeSearchPanelBtn.classList.add('hidden'); // Hide close button by default for desktop

        // Remove active class from all nav items
        document.querySelectorAll('.nav-item').forEach(item => {
            item.classList.remove('active-nav');
            item.classList.add('inactive-nav');
        });

        if (isMobile) {
            console.log("setActiveView: Mobile view detected.");
            toggleNavBtn.classList.remove('hidden'); // Always show nav toggle on mobile

            // Handle nav panel visibility on mobile
            if (state.isNavOpen) {
                navPanel.classList.remove('hidden');
                navPanel.style.width = '100%'; // Full width for mobile nav
                mobileNavHeader.classList.remove('hidden'); // Show mobile nav header
                mainContentWrapper.classList.add('hidden'); // Hide main content when nav is open
            } else {
                navPanel.classList.add('hidden');
                mobileNavHeader.classList.add('hidden'); // Hide mobile nav header
                mainContentWrapper.classList.remove('hidden'); // Show main content when nav is closed
            }

            if (state.isSearchVisible) {
                searchPanel.classList.remove('hidden');
                searchPanel.classList.add('absolute', 'inset-0', 'z-20');
                searchPanel.style.width = '100%';
                toggleSearchBtn.innerHTML = `<i data-lucide="x" class="w-5 h-5"></i>`;
                toggleSearchBtn.title = "Close Search";
                closeSearchPanelBtn.classList.remove('hidden');

                mainContentWrapper.classList.add('hidden'); // Hide main content on mobile if search is open
            } else {
                // Only show main content if nav is also closed
                if (!state.isNavOpen) {
                    mainContentWrapper.classList.remove('hidden');
                    const activePanel = contentPanels[state.activeView];
                    if (activePanel) {
                        activePanel.classList.remove('hidden');
                    }
                }
                mainContentWrapper.style.width = '100%'; // Main content wrapper takes full width on mobile
                toggleSearchBtn.innerHTML = `<i data-lucide="search" class="w-5 h-5"></i>`;
                toggleSearchBtn.title = "Show Search";
            }
        } else { // Desktop/Tablet behavior
            console.log("setActiveView: Desktop/Tablet view detected.");
            toggleNavBtn.classList.remove('hidden'); // Always show nav toggle on desktop
            mainContentWrapper.classList.remove('hidden'); // Ensure wrapper is visible

            const activePanel = contentPanels[state.activeView];
            if (activePanel) {
                activePanel.classList.remove('hidden');
            }

            const activeNavItem = document.querySelector(`.nav-item[data-view="${state.activeView}"]`);
            if (activeNavItem) {
                activeNavItem.classList.remove('inactive-nav');
                activeNavItem.classList.add('active-nav');
            }

            // Apply nav panel width and visibility
            if (state.isNavOpen) {
                navPanel.classList.remove('hidden');
                navResizeHandle.classList.remove('hidden');
                navPanel.style.width = `${state.navWidth}px`;
            } else {
                navPanel.style.width = `0px`; // Collapse nav panel
            }

            // Apply search panel width and visibility
            if (state.isSearchVisible) {
                searchPanel.classList.remove('hidden');
                searchResizeHandle.classList.remove('hidden');
                searchPanel.style.width = `${state.searchWidth}px`;
                toggleSearchBtn.innerHTML = `<i data-lucide="message-square" class="w-5 h-5"></i>`;
                toggleSearchBtn.title = "Hide Search";
            } else {
                searchPanel.style.width = `0px`; // Collapse search panel
                toggleSearchBtn.innerHTML = `<i data-lucide="search" class="w-5 h-5"></i>`;
                toggleSearchBtn.title = "Show Search";
            }

            // Specific rendering for console when active
            if (view === 'console') {
                renderConsoleLogs();
            }
        }
        lucide.createIcons();
    };


    const toggleSearchView = () => {
        console.log("toggleSearchView: Toggling search view visibility.");
        state.isSearchVisible = !state.isSearchVisible;
        // If search is being opened, ensure chat is the active content view
        if (state.isSearchVisible && state.activeView !== 'chat') {
            state.activeView = 'chat';
        }
        setActiveView(state.activeView); 
    };

    const toggleNavView = () => {
        console.log("toggleNavView: Toggling navigation view visibility.");
        state.isNavOpen = !state.isNavOpen;
        setActiveView(state.activeView);
    };

    // --- Chat History Logic ---
    const saveMessages = () => localStorage.setItem('chatMessages', JSON.stringify(state.messages));
    
    const renderMessages = () => {
        console.log("renderMessages: Rendering chat messages.");
        messagesContainer.innerHTML = '';
        const renderSingleMessage = (msg, isTyping = false) => {
            console.log(`renderSingleMessage: Rendering message ID: ${msg.id}, Role: ${msg.role}, rawContent: "${msg.rawContent}", htmlContent: "${msg.htmlContent}"`);
            const isUser = msg.role === 'user';
            const formattedTime = new Date(msg.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            if (state.editingMessageId === msg.id) {
                console.log(`renderSingleMessage: Rendering message ${msg.id} in edit mode.`);
                return `
                <div class="flex items-start space-x-3 justify-end">
                    <div class="max-w-xs lg:max-w-md xl:max-w-lg order-1 w-full">
                        <div class="p-3 rounded-xl bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 shadow-sm">
                            <textarea class="w-full px-2 py-1 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md resize-y text-sm" rows="3">${msg.rawContent}</textarea>
                            <div class="mt-2 flex justify-end space-x-2">
                                <button data-action="cancel-edit" class="px-3 py-1 text-xs font-semibold rounded-md hover:bg-gray-200 dark:hover:bg-gray-700">Cancel</button>
                                <button data-action="save-edit" data-message-id="${msg.id}" class="px-3 py-1 text-xs font-semibold rounded-md bg-primary-600 text-white hover:bg-primary-700">Save & Submit</button>
                            </div>
                        </div>
                    </div>
                    <div class="flex-shrink-0 w-8 h-8 bg-primary-200 dark:bg-primary-700 rounded-full flex items-center justify-center order-2"><i data-lucide="user" class="w-4 h-4 text-primary-800 dark:text-primary-200"></i></div>
                </div>`;
            }

            const actionButtons = `
                <div class="mt-1 flex items-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity ${isUser ? 'justify-end' : ''}">
                    ${isUser ? `
                        <button data-action="edit" data-message-id="${msg.id}" title="Edit" class="p-1 text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"><i data-lucide="pencil" class="w-3.5 h-3.5 pointer-events-none"></i></button>
                        <button data-action="regenerate" data-message-id="${msg.id}" title="Regenerate" class="p-1 text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"><i data-lucide="refresh-cw" class="w-3.5 h-3.5 pointer-events-none"></i></button>
                    ` : `
                        <button data-action="regenerate" data-message-id="${msg.id}" title="Regenerate" class="p-1 text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"><i data-lucide="refresh-cw" class="w-3.5 h-3.5 pointer-events-none"></i></button>
                    `}
                    <button data-action="copy-message" data-copy-content="${encodeURIComponent(msg.rawContent)}" title="Copy message" class="p-1 text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"><i data-lucide="copy" class="w-3.5 h-3.5 pointer-events-none"></i></button>
                    <button data-action="delete-message" data-message-id="${msg.id}" title="Delete message" class="p-1 text-red-400 hover:text-red-600 dark:hover:text-red-300"><i data-lucide="trash-2" class="w-3.5 h-3.5 pointer-events-none"></i></button>
                </div>
            `;

            return `
            <div class="flex items-start space-x-3 ${isUser ? 'justify-end' : ''} group relative animate-fade-in-up">
                ${!isUser ? `<div class="flex-shrink-0 w-8 h-8 bg-primary-600 dark:bg-primary-700 rounded-full flex items-center justify-center overflow-hidden"><img src="https://v1.sefgh.org/assets/favicon.png" alt="Bot Icon" class="w-full h-full object-cover"></div>` : ''}
                <div class="max-w-xs lg:max-w-md xl:max-w-lg ${isUser ? 'order-1' : ''}">
                    <div class="px-4 py-3 rounded-xl ${isUser ? 'bg-primary-600 text-white' : 'bg-gray-100 dark:bg-gray-800'} shadow-md">
                        <div class="text-sm whitespace-pre-wrap">${msg.htmlContent}${isTyping ? '<span class="inline-flex items-center ml-2"><span class="w-1.5 h-1.5 bg-current rounded-full animate-pulse"></span><span class="w-1.5 h-1.5 bg-current rounded-full animate-pulse delay-150 ml-1"></span><span class="w-1.5 h-1.5 bg-current rounded-full animate-pulse delay-300 ml-1"></span></span>' : ''}</div>
                    </div>
                    <div class="mt-1 flex items-center justify-between">
                        ${!isTyping ? `<div class="text-xs text-gray-500 dark:text-gray-400 ${isUser ? 'ml-auto' : ''}">${formattedTime}</div>` : '<div></div>' }
                    </div>
                    ${!isTyping && !state.isTyping ? actionButtons : ''}
                </div>
                ${isUser ? `<div class="flex-shrink-0 w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center order-2"><i data-lucide="user" class="w-4 h-4 text-gray-600 dark:text-gray-400"></i></div>` : ''}
            </div>`;
        };

        if (state.messages.length === 0 && !state.isTyping) {
            messagesContainer.innerHTML = `
                <div class="text-center text-gray-500 dark:text-gray-400 mt-8">
                    <div class="w-12 h-12 mx-auto mb-4 text-primary-500 flex items-center justify-center animate-bounce-in">
                        <i data-lucide="message-square" class="w-full h-full"></i>
                    </div>
                    <h3 data-i18n="welcomeTitle" class="text-lg font-medium mb-2 animate-fade-in-up">Welcome to SEFGH!</h3>
                    <p data-i18n="welcomeMessage" class="text-sm animate-fade-in-up" style="animation-delay: 0.2s;">How can I help you explore GitHub today?</p>
                </div>`;
            clearChatHistoryBtn.classList.add('hidden');
        } else {
            messagesContainer.innerHTML = state.messages.map(msg => renderSingleMessage(msg)).join('');
            clearChatHistoryBtn.classList.remove('hidden');
        }
        if (state.isTyping) {
            messagesContainer.innerHTML += renderSingleMessage({ role: 'assistant', rawContent: '', htmlContent: '' }, true);
        }
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
        lucide.createIcons();
    };
    
    const addMessage = (content, role) => { 
        console.log(`addMessage: Adding message - Role: ${role}, Content (before HTML parse): "${content}", Type: ${typeof content}`);
        // For assistant messages, we're now displaying raw JSON, so no Markdown parsing needed.
        // For user messages, content is already plain text.
        const htmlContent = content; 
        console.log(`addMessage: Adding message - Role: ${role}, HTML Content (after HTML parse): "${htmlContent}", Type: ${typeof htmlContent}`);
        state.messages.push({ id: Date.now(), rawContent: content, htmlContent, role, timestamp: new Date() }); 
        saveMessages(); 
        renderMessages(); 
    };
    const clearChatHistory = () => { 
        console.log("clearChatHistory: Clearing chat history.");
        state.messages = []; 
        saveMessages(); 
        renderMessages(); 
    };
    const handleSendMessage = (e) => { 
        e.preventDefault(); 
        const message = chatTextarea.value.trim(); 
        if (!message) return;

        // Removed the version check here as the user explicitly wants to use their API
        // if (state.selectedVersionId !== 'v1') {
        //     showNotification(translations[state.selectedLanguage].apiErrorMessage("The AI API is only enabled for SEFGH v1.0. Please switch to v1.0 to use AI features."), 'info');
        //     chatTextarea.value = ''; 
        //     chatTextarea.style.height = 'auto'; 
        //     updateChatInputState(); 
        //     return; 
        // }

        if (!state.isTyping) { 
            console.log(`handleSendMessage: User input received: "${message}"`);
            addMessage(message, 'user'); 
            chatTextarea.value = ''; 
            chatTextarea.style.height = 'auto'; 
            updateChatInputState(); 
            processUserMessage(message); 
        } 
    };
    const updateChatInputState = () => {
        const hasText = chatTextarea.value.trim().length > 0;
        sendBtn.disabled = !hasText || state.isTyping;
        chatTextarea.disabled = state.isTyping;

        if (chatTextarea.scrollHeight > chatTextarea.clientHeight) {
            chatTextarea.classList.add('overflow-y-auto');
        } else {
            chatTextarea.classList.remove('overflow-y-auto');
        }
    };

    // --- Search History Logic ---
    const saveSearchHistory = (query) => {
        console.log(`saveSearchHistory: Saving search query: "${query}"`);
        const trimmedQuery = query.trim();
        if (!trimmedQuery || state.searchHistory.includes(trimmedQuery)) return;
        state.searchHistory.unshift(trimmedQuery);
        if (state.searchHistory.length > 50) state.searchHistory.pop();
        localStorage.setItem('searchHistory', JSON.stringify(state.searchHistory));
        // renderHistoryPanel(); // No longer called directly from here, as history is a content panel
    };
    const renderHistoryPanel = () => {
        console.log("renderHistoryPanel: Rendering search history panel.");
        if (state.searchHistory.length === 0) {
            historyContainer.innerHTML = `<div class="text-center text-gray-500 dark:text-gray-400 mt-8"><i data-lucide="search-x" class="w-12 h-12 mx-auto mb-4 text-red-400"></i><h3 data-i18n="noChatHistory" class="text-lg font-medium mb-2">No Chat History</h3><p data-i18n="chatHistoryEmptyMessage" class="text-sm">Your past conversations will appear here.</p></div>`;
            clearSearchHistoryBtn.classList.add('hidden');
        } else {
            historyContainer.innerHTML = `<ul class="space-y-2">${state.searchHistory.map(term => `<li><button class="history-item-btn w-full text-left p-3 rounded-xl hover:bg-gray-200 dark:hover:bg-gray-700/80 transition-colors flex justify-between items-center shadow-sm" data-query="${term}"><span class="font-medium text-gray-800 dark:text-gray-200 pointer-events-none">${term}</span><i data-lucide="search" class="w-4 h-4 text-gray-400 pointer-events-none"></i></button></li>`).join('')}</ul>`;
            clearSearchHistoryBtn.classList.remove('hidden');
        }
        lucide.createIcons();
    };
    const clearSearchHistory = () => { 
        console.log("clearSearchHistory: Clearing search history.");
        state.searchHistory = []; 
        localStorage.removeItem('searchHistory'); 
        renderHistoryPanel(); 
    };

    // --- Repository Search Logic ---
    const searchRepositories = async (query) => {
        console.log(`searchRepositories: Initiating search for: "${query}"`);

        // Trim the query and check if it's empty or too short after trimming
        const trimmedQuery = query.trim();
        if (!trimmedQuery || trimmedQuery.length < 2) {
            console.log("searchRepositories: Query is empty or too short after trimming, rendering initial search state.");
            renderSearchInitial();
            return;
        }

        // Further validate if the query contains actual "searchable" characters
        // A simple regex check for at least one word character (alphanumeric or underscore)
        if (!/\w/.test(trimmedQuery)) {
            console.log("searchRepositories: Query contains no searchable characters, rendering initial search state.");
            renderSearchInitial();
            return;
        }

        saveSearchHistory(trimmedQuery); // Use trimmedQuery for history
        renderSearchLoading();
        try {
            // Log the full URL for debugging
            const apiUrl = `https://api.github.com/search/repositories?q=${encodeURIComponent(trimmedQuery)}&sort=stars&per_page=20`;
            console.log("searchRepositories: Fetching URL:", apiUrl);

            const response = await fetch(apiUrl, {
                headers: {
                    'Accept': 'application/vnd.github.v3+json' // Explicitly request v3 API
                }
            });
            if (!response.ok) {
                const errorData = await response.json();
                const errorMessage = errorData.message || `API Error: ${response.status}`;
                console.error("searchRepositories: GitHub API error:", errorMessage);
                throw new Error(errorMessage);
            }
            const data = await response.json(); 
            console.log("searchRepositories: GitHub API response received:", data);
            if (data.items.length === 0) {
                console.log("searchRepositories: No results found.");
                renderSearchEmpty(trimmedQuery); // Use trimmedQuery for empty message
            } else {
                console.log(`searchRepositories: Found ${data.items.length} results.`);
                renderSearchResults(data.items); 
            }
        } catch (error) { 
            console.error("searchRepositories: Search failed:", error.message);
            renderSearchError(error.message); 
        } 
    };
    const renderSearchInitial = () => { 
        console.log("renderSearchInitial: Displaying initial search prompt."); 
        searchResultsContainer.innerHTML = `
            <div class="text-center text-gray-500 dark:text-gray-400 mt-8">
                <i data-lucide="folder-search" class="w-16 h-16 mx-auto mb-4 text-primary-400"></i>
                <h3 data-i18n="repoSearchInitialTitle" class="text-lg font-medium mb-2">Repository Search</h3>
                <p data-i18n="repoSearchInitialMessage" class="text-sm">Results from your chat will appear here.</p>
            </div>`; 
        lucide.createIcons(); 
    };
    const renderSearchLoading = () => { console.log("renderSearchLoading: Displaying search loading skeletons."); let skeletons = Array(5).fill('').map(() => `<div class="bg-white dark:bg-gray-700 p-4 rounded-xl shadow-md animate-pulse-fast"><div class="h-4 bg-gray-200 dark:bg-gray-600 rounded w-3/4 mb-3"></div><div class="h-3 bg-gray-200 dark:bg-gray-600 rounded w-full mb-1"></div><div class="h-3 bg-gray-200 dark:bg-gray-600 rounded w-5/6 mb-4"></div><div class="flex items-center space-x-4"><div class="h-4 bg-gray-200 dark:bg-gray-600 rounded w-1/4"></div><div class="h-4 bg-gray-200 dark:bg-gray-600 rounded w-1/4"></div></div></div>`).join(''); searchResultsContainer.innerHTML = `<div class="space-y-4">${skeletons}</div>`; lucide.createIcons(); };
    const renderSearchResults = (items) => { console.log("renderSearchResults: Displaying search results."); const cardsHtml = items.map(item => `<div class="bg-white dark:bg-gray-800/50 p-4 rounded-xl border border-gray-200 dark:border-gray-700/50 shadow-md hover:shadow-lg hover:border-primary-500 dark:hover:border-primary-400 transition-all duration-200"><div class="flex justify-between items-start"><a href="${item.html_url}" target="_blank" rel="noopener noreferrer" class="font-semibold text-gray-800 dark:text-gray-200 hover:underline mb-1 pr-2">${item.full_name}</a><div class="flex-shrink-0 flex items-center space-x-3 text-gray-500 dark:text-gray-400"><span class="flex items-center text-sm"><i data-lucide="star" class="w-4 h-4 mr-1 text-yellow-500"></i>${formatNumber(item.stargazers_count)}</span><span class="flex items-center text-sm"><i data-lucide="git-fork" class="w-4 h-4 mr-1 text-purple-400"></i>${formatNumber(item.forks_count)}</span></div></div><p class="text-sm text-gray-600 dark:text-gray-300 my-2">${item.description || 'No description provided.'}</p><div class="flex items-center justify-between mt-3 text-xs text-gray-500 dark:text-gray-400"><div class="flex items-center space-x-4">${item.language ? `<span class="flex items-center"><i data-lucide="code" class="w-3 h-3 mr-1.5 text-cyan-400"></i>${item.language}</span>` : ''}${item.license ? `<span class="flex items-center"><i data-lucide="scale" class="w-3 h-3 mr-1.5 text-green-400"></i>${item.license.spdx_id}</span>` : ''}</div><span>Updated ${new Date(item.updated_at).toLocaleDateString()}</span></div><div class="mt-4 pt-3 border-t border-gray-200 dark:border-gray-700 flex items-center space-x-2"><button class="copy-btn text-xs bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 px-2 py-1 rounded-md flex items-center" data-copy="${item.html_url}"><i data-lucide="link" class="w-3 h-3 mr-1.5 text-indigo-400"></i>Copy URL</button><button class="copy-btn text-xs bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 px-2 py-1 rounded-md flex items-center" data-copy="${item.clone_url}"><i data-lucide="terminal" class="w-3 h-3 mr-1.5 text-emerald-400"></i>Copy Clone</button></div></div>`).join(''); searchResultsContainer.innerHTML = `<div class="space-y-4">${cardsHtml}</div>`; lucide.createIcons(); };
    const renderSearchEmpty = (query) => { 
        console.log(`renderSearchEmpty: No results for query: "${query}"`); 
        searchResultsContainer.innerHTML = `
            <div class="text-center text-gray-500 dark:text-gray-400 mt-8">
                <i data-lucide="search-x" class="w-16 h-16 mx-auto mb-4 text-red-400"></i>
                <h3 data-i18n="noResultsFoundTitle" class="text-lg font-medium mb-2">No Results Found</h3>
                <p class="text-sm">${translations[state.selectedLanguage].noResultsFoundMessage(query)}</p>
            </div>`; 
        lucide.createIcons(); 
    };
    const renderSearchError = (message) => { 
        console.error(`renderSearchError: Displaying search error: "${message}"`); 
        searchResultsContainer.innerHTML = `
            <div class="text-center text-red-500 dark:text-red-400 mt-8 p-4 bg-red-50 dark:bg-red-900/20 rounded-lg">
                <i data-lucide="alert-triangle" class="w-16 h-16 mx-auto mb-4 text-red-600"></i>
                <h3 data-i18n="anErrorOccurred" class="text-lg font-medium mb-2">An Error Occurred</h3>
                <p class="text-sm">${translations[state.selectedLanguage].apiErrorMessage(message)}</p>
            </div>`; 
        lucide.createIcons(); 
    };
    
    const handleSearchTrigger = (query) => { 
        console.log(`handleSearchTrigger: Called with query: "${query}"`);
    };
    
    // --- Resize Logic ---
    const handleResizeMouseDown = (e) => { 
        e.preventDefault(); 
        const targetId = e.target.id;
        if (targetId === 'nav-resize-handle') {
            state.isResizing = 'nav';
        } else if (targetId === 'search-resize-handle') {
            state.isResizing = 'search';
        }
        appContainer.style.cursor = 'col-resize'; 
        document.addEventListener('mousemove', handleResizeMouseMove); 
        document.addEventListener('mouseup', handleResizeMouseUp); 
    };

    const handleResizeMouseMove = (e) => {
        const isMobile = window.innerWidth < 768;
        if (isMobile || !state.isResizing) return;

        const panelContainerRect = panelContainer.getBoundingClientRect();

        if (state.isResizing === 'nav') {
            let newNavWidth = e.clientX - panelContainerRect.left;
            newNavWidth = Math.max(150, Math.min(panelContainerRect.width * 0.4, newNavWidth)); // Constrain nav width
            state.navWidth = newNavWidth;
            navPanel.style.width = `${state.navWidth}px`;
            localStorage.setItem('navWidth', state.navWidth);
            // Re-render layout to adjust mainContentWrapper width
            setActiveView(state.activeView);

        } else if (state.isResizing === 'search') {
            let newSearchWidthPx = panelContainerRect.right - e.clientX;
            newSearchWidthPx = Math.max(200, Math.min(panelContainerRect.width * 0.7, newSearchWidthPx)); // Constrain search width
            state.searchWidth = newSearchWidthPx;
            searchPanel.style.width = `${state.searchWidth}px`;
            localStorage.setItem('searchWidth', state.searchWidth);
            // Re-render layout to adjust mainContentWrapper width
            setActiveView(state.activeView);
        }
    };

    const handleResizeMouseUp = () => { 
        state.isResizing = null; 
        appContainer.style.cursor = 'default'; 
        document.removeEventListener('mousemove', handleResizeMouseMove); 
        document.removeEventListener('mouseup', handleResizeMouseUp); 
    };
    
    // --- Version Switcher Logic ---
    const renderVersionDropdown = () => {
        const versionMenuEl = getEl('version-menu'); 
        const versionNameEl = getEl('version-name'); 
        const versionChevronEl = getEl('version-chevron'); 
        const selectedVersion = state.versions.find(v => v.id === state.selectedVersionId);
        versionNameEl.textContent = selectedVersion.name;
        if (state.isVersionDropdownOpen) { versionMenuEl.classList.remove('hidden'); setTimeout(() => { versionMenuEl.style.transform = 'scale(1)'; versionMenuEl.style.opacity = '1'; }, 10); versionChevronEl.setAttribute('data-lucide', 'chevron-up'); } else { versionMenuEl.style.transform = 'scale(0.95)'; versionMenuEl.style.opacity = '0'; setTimeout(() => { versionMenuEl.classList.add('hidden'); }, 150); versionChevronEl.setAttribute('data-lucide', 'chevron-down'); }
        versionMenuEl.innerHTML = state.versions.map(v => `<button class="version-item w-full text-left flex flex-col p-2 hover:bg-gray-100 dark:hover:bg-slate-700/50 transition-colors" data-version-id="${v.id}"><span class="font-semibold text-sm pointer-events-none ${v.id === state.selectedVersionId ? 'text-primary-800 dark:text-primary-100' : 'text-gray-800 dark:text-gray-200'}">${v.name}</span><span class="text-xs text-gray-500 dark:text-gray-400 mt-1 pointer-events-none">${v.description}</span></button>`).join('');
        lucide.createIcons();
    };

    // --- AI Response Logic ---
    const processUserMessage = async (userInput) => {
        console.log(`processUserMessage: Starting for input: "${userInput}"`);
        state.isTyping = true;
        renderMessages();
        updateChatInputState(); 

        const API_URL = 'https://api.sefgh.org'; // Your custom LLM API endpoint

        try {
            // Prepare payload for your custom API
            const payload = { message: userInput };

            console.log("processUserMessage: Sending payload to custom LLM API:", payload);

            const response = await fetch(API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            state.isTyping = false; // Turn off typing indicator once response is received

            if (!response.ok) {
                let errorText = `Custom LLM API Error: ${response.status} ${response.statusText}`;
                try {
                    const errorData = await response.json();
                    errorText = errorData.detail || errorData.message || JSON.stringify(errorData);
                } catch (jsonError) {
                    console.error("processUserMessage: Error parsing custom LLM API error response:", jsonError);
                }
                console.error("processUserMessage: Custom LLM API response not OK:", errorText);
                throw new Error(errorText);
            }

            const result = await response.json();
            console.log("processUserMessage: Raw Custom LLM API response received:", result);

            // Display the raw JSON response directly in the chat
            let assistantMessage = JSON.stringify(result, null, 2); // Pretty print the entire result object
            addMessage(assistantMessage, 'assistant');
            console.log("processUserMessage: Added raw AI response to chat.");

        } catch (error) {
            console.error("processUserMessage: LLM API Call failed:", error);
            state.isTyping = false; // Ensure typing indicator is off on error
            const userFriendlyError = translations[state.selectedLanguage].llmApiFailed;
            addMessage(userFriendlyError, 'assistant');
        } finally {
            // Ensure typing indicator is off regardless of success or failure
            if (state.isTyping) { state.isTyping = false; }
            renderMessages();
            updateChatInputState();
            console.log("processUserMessage: Finished processing user message.");
        }
    };

    // --- Console Logging Logic (NEW) ---
    const setupConsoleLogger = () => {
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        const originalInfo = console.info;

        const captureLog = (type, args) => {
            const timestamp = new Date().toISOString();
            const message = args.map(arg => {
                if (typeof arg === 'object' && arg !== null) {
                    try {
                        return JSON.stringify(arg, null, 2);
                    } catch (e) {
                        return String(arg); // Fallback for circular references or complex objects
                    }
                }
                return String(arg);
            }).join(' ');
            state.consoleLogs.push({ type, message, timestamp });
            // Limit the number of logs to prevent memory issues
            if (state.consoleLogs.length > 1000) { // Keep last 1000 logs
                state.consoleLogs.shift();
            }
            // Only re-render if console is the active view to avoid unnecessary DOM updates
            if (state.activeView === 'console') {
                renderConsoleLogs();
            }
        };

        console.log = (...args) => {
            originalLog.apply(console, args);
            captureLog('log', args);
        };
        console.error = (...args) => {
            originalError.apply(console, args);
            captureLog('error', args);
        };
        console.warn = (...args) => {
            originalWarn.apply(console, args);
            captureLog('warn', args);
        };
        console.info = (...args) => {
            originalInfo.apply(console, args);
            captureLog('info', args);
        };
    };

    const renderConsoleLogs = () => {
        if (!consoleOutput) return; // Ensure element exists
        consoleOutput.innerHTML = '';
        state.consoleLogs.forEach(log => {
            const logLine = document.createElement('div');
            let textColorClass = 'text-gray-100'; // Default for log
            if (log.type === 'error') {
                textColorClass = 'text-red-400';
            } else if (log.type === 'warn') {
                textColorClass = 'text-yellow-400';
            } else if (log.type === 'info') {
                textColorClass = 'text-blue-300';
            }
            logLine.className = `whitespace-pre-wrap break-words ${textColorClass}`;
            logLine.textContent = `[${log.timestamp.substring(11, 19)}] [${log.type.toUpperCase()}] ${log.message}`;
            consoleOutput.appendChild(logLine);
        });
        consoleOutput.scrollTop = consoleOutput.scrollHeight; // Scroll to bottom
    };

    const copyConsoleLogs = () => {
        const allLogsText = state.consoleLogs.map(log => `[${log.timestamp.substring(11, 19)}] [${log.type.toUpperCase()}] ${log.message}`).join('\n');
        document.execCommand('copy', false, allLogsText);
        showNotification(translations[state.selectedLanguage].logCopied, 'success', 3000);
    };

    const downloadConsoleLogs = () => {
        const allLogsText = state.consoleLogs.map(log => `[${log.timestamp.substring(11, 19)}] [${log.type.toUpperCase()}] ${log.message}`).join('\n');
        const blob = new Blob([allLogsText], { type: 'text/plain;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `console_log_${new Date().toISOString().replace(/[:.]/g, '-')}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        showNotification(translations[state.selectedLanguage].logDownloaded, 'success', 3000);
    };

    // --- Theme & GitHub Helper Functions ---
    const toggleTheme = () => {
        console.log("Theme toggle clicked.");
        state.theme = state.theme === 'light' ? 'dark' : 'light'; 
        localStorage.setItem('theme', state.theme); 
        htmlEl.className = state.theme; 
        // Update both theme toggle buttons
        const themeIconHtml = state.theme === 'dark' ? '<i data-lucide="sun" class="w-5 h-5 text-yellow-500"></i>' : '<i data-lucide="moon" class="w-5 h-5 text-indigo-400"></i>';
        if (mainHeaderThemeToggleBtn) mainHeaderThemeToggleBtn.innerHTML = themeIconHtml;
        if (mobileNavThemeToggleBtn) mobileNavThemeToggleBtn.innerHTML = themeIconHtml;
        lucide.createIcons(); 
    };

    const openGitHubRepo = () => {
        console.log("GitHub button clicked.");
        window.open('https://github.com/sefgh-ai/hostSefgh', '_blank');
    };


    // --- Event Listeners Setup ---
    const setupEventListeners = () => {
        console.log("setupEventListeners: Setting up event listeners.");
        // Header listeners
        toggleSearchBtn.addEventListener('click', toggleSearchView); 
        toggleNavBtn.addEventListener('click', toggleNavView); 
        
        // Theme toggle listeners (for both main header and mobile nav)
        if (mainHeaderThemeToggleBtn) mainHeaderThemeToggleBtn.addEventListener('click', toggleTheme);
        if (mobileNavThemeToggleBtn) mobileNavThemeToggleBtn.addEventListener('click', toggleTheme);

        // GitHub icon listeners (for both main header and mobile nav)
        if (mainHeaderGithubBtn) mainHeaderGithubBtn.addEventListener('click', openGitHubRepo);
        if (mobileNavGithubBtn) mobileNavGithubBtn.addEventListener('click', openGitHubRepo);

        // Chat listeners
        chatForm.addEventListener('submit', handleSendMessage);
        clearChatHistoryBtn.addEventListener('click', clearChatHistory); // Corrected ID
        chatTextarea.addEventListener('input', () => { 
            chatTextarea.style.height = 'auto'; 
            chatTextarea.style.height = `${chatTextarea.scrollHeight}px`; 
            updateChatInputState(); 
        });
        chatTextarea.addEventListener('keydown', (e) => { 
            if (e.key === 'Enter' && !e.shiftKey) { 
                console.log("Chat textarea: Enter key pressed (no shift).");
                e.preventDefault(); 
                handleSendMessage(e); 
            } 
        });

        // Event delegation for message actions (Edit, Save, Cancel, Regenerate, Copy, Delete)
        messagesContainer.addEventListener('click', (e) => {
            if (state.isTyping) {
                console.log("messagesContainer: Ignoring click, AI is typing.");
                return; 
            }
            const button = e.target.closest('button[data-action]');
            if (!button) return;

            const action = button.dataset.action;
            const messageId = parseInt(button.dataset.messageId, 10);
            console.log(`messagesContainer: Action "${action}" triggered for message ID: ${messageId}`);

            switch(action) {
                case 'edit':
                    state.editingMessageId = messageId;
                    renderMessages();
                    break;
                
                case 'cancel-edit':
                    state.editingMessageId = null;
                    renderMessages();
                    break;
                
                case 'save-edit':
                    const messageWrapper = button.closest('.max-w-xs');
                    const textarea = messageWrapper.querySelector('textarea');
                    const newContent = textarea.value.trim();
                    const msgIndex = state.messages.findIndex(m => m.id === messageId);

                    if (newContent && msgIndex !== -1 && state.messages[msgIndex].rawContent !== newContent) {
                        console.log(`messagesContainer: Saving edited message ${messageId} and re-submitting.`);
                        state.messages = state.messages.slice(0, msgIndex);
                        state.editingMessageId = null;
                        
                        addMessage(newContent, 'user');
                        processUserMessage(newContent);
                    } else {
                        console.log(`messagesContainer: Edit canceled or content unchanged for message ${messageId}.`);
                        state.editingMessageId = null;
                        renderMessages();
                    }
                    break;
                
                case 'regenerate':
                    const msgToRegenerateIndex = state.messages.findIndex(m => m.id === messageId);
                    if (msgToRegenerateIndex === -1) {
                        console.warn(`messagesContainer: Message with ID ${messageId} not found for regeneration.`);
                        return;
                    }

                    const messageToRegenerate = state.messages[msgToRegenerateIndex];

                    if (messageToRegenerate.role === 'user') {
                        // Regenerate for a user message: remove this message and all subsequent messages
                        console.log(`messagesContainer: Regenerating response for user message ID: ${messageId}.`);
                        state.messages = state.messages.slice(0, msgToRegenerateIndex + 1); // Keep the user message
                        saveMessages();
                        renderMessages();
                        processUserMessage(messageToRegenerate.rawContent);
                    } else if (messageToRegenerate.role === 'assistant') {
                        // Regenerate for an assistant message: find preceding user prompt and regenerate from there
                        console.log(`messagesContainer: Regenerating response for assistant message ID: ${messageId}.`);
                        const userPromptIndex = state.messages.slice(0, msgToRegenerateIndex).reverse().findIndex(m => m.role === 'user');
                        if (userPromptIndex !== -1) {
                            const actualUserPromptIndex = msgToRegenerateIndex - 1 - userPromptIndex;
                            const userPrompt = state.messages[actualUserPromptIndex].rawContent;
                            state.messages = state.messages.slice(0, actualUserPromptIndex + 1); // Keep the user prompt
                            saveMessages();
                            renderMessages();
                            processUserMessage(userPrompt);
                        } else {
                            console.warn(`messagesContainer: Could not find a preceding user prompt to regenerate for assistant message ID: ${messageId}.`);
                        }
                    }
                    break;
                
                case 'copy-message':
                    const contentToCopy = decodeURIComponent(button.dataset.copyContent);
                    document.execCommand('copy', false, contentToCopy);
                    const originalCopyHtml = button.innerHTML;
                    button.innerHTML = `<i data-lucide="check" class="w-3.5 h-3.5 text-green-500 pointer-events-none"></i>`;
                    lucide.createIcons();
                    setTimeout(() => {
                        button.innerHTML = originalCopyHtml;
                        lucide.createIcons();
                    }, 2000);
                    showNotification(translations[state.selectedLanguage].messageCopied, 'success', 3000); 
                    break;

                case 'delete-message':
                    console.log(`messagesContainer: Deleting message ID: ${messageId}.`);
                    state.messages = state.messages.filter(msg => msg.id !== messageId);
                    saveMessages();
                    renderMessages();
                    showNotification(translations[state.selectedLanguage].messageDeleted, 'info', 3000);
                    break;
            }
        });

        // Nav Items Listener (Delegation)
        navItemsContainer.addEventListener('click', (e) => {
            const navItem = e.target.closest('.nav-item');
            if (navItem) {
                const view = navItem.dataset.view;
                console.log(`Nav item clicked: ${view}`);
                
                // Special handling for 'search' view from 'All Pages'
                if (view === 'search') {
                    state.isSearchVisible = !state.isSearchVisible; // Toggle search panel
                    state.activeView = 'chat'; // Keep chat as the main view
                } else {
                    state.isSearchVisible = false; // Ensure search panel is closed for other main views
                    state.activeView = view;
                }
                setActiveView(state.activeView);

                // Call specific render functions if needed for the new view
                if (view === 'chat-history') {
                    renderHistoryPanel(); // Ensure history is rendered when its view is active
                } else if (view === 'console') { // NEW: Render console logs when console view is active
                    renderConsoleLogs();
                }
                // For 'new-chat', 'docs', 'playground', 'console', 'language', 'settings',
                // their content sections are static placeholders or will be rendered by other logic.
            }
        });

        // NEW: All Pages Panel Link Listener (Delegation)
        allPagesPanel.addEventListener('click', (e) => {
            const pageLinkCard = e.target.closest('.page-link-card');
            if (pageLinkCard) {
                const view = pageLinkCard.dataset.view;
                console.log(`All Pages card clicked: ${view}`);
                
                // Special handling for 'search' view from 'All Pages'
                if (view === 'search') {
                    state.isSearchVisible = !state.isSearchVisible; // Toggle search panel
                    state.activeView = 'chat'; // Keep chat as the main view
                } else {
                    state.isSearchVisible = false; // Ensure search panel is closed for other main views
                    state.activeView = view;
                }
                setActiveView(state.activeView);

                if (view === 'chat-history') {
                    renderHistoryPanel();
                } else if (view === 'console') {
                    renderConsoleLogs();
                }
            }
        });

        // Language Panel Listener (Delegation)
        languagePanel.addEventListener('click', (e) => {
            const langButton = e.target.closest('.lang-select-btn');
            if (langButton) {
                const langCode = langButton.dataset.lang;
                if (langCode && langCode !== state.selectedLanguage) {
                    setLanguage(langCode);
                }
            }
        });


        // Search & History Listeners
        navResizeHandle.addEventListener('mousedown', handleResizeMouseDown); 
        searchResizeHandle.addEventListener('mousedown', handleResizeMouseDown); 
        searchInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                console.log("Search input: Enter key pressed.");
                e.preventDefault(); 
                searchRepositories(searchInput.value);
            }
        });
        searchResultsContainer.addEventListener('click', (e) => { 
            const button = e.target.closest('.copy-btn'); 
            if (button) { 
                console.log(`Copy button clicked for: "${button.dataset.copy}"`);
                document.execCommand('copy', false, button.dataset.copy); 
                const originalText = button.innerHTML; 
                button.innerHTML = `<i data-lucide="check" class="w-3 h-3 mr-1.5 text-green-500"></i>Copied!`; 
                lucide.createIcons(); 
                setTimeout(() => { 
                    button.innerHTML = originalText; 
                    lucide.createIcons(); 
                }, 2000); 
            } 
        });
        clearSearchHistoryBtn.addEventListener('click', clearSearchHistory);
        closeSearchPanelBtn.addEventListener('click', toggleSearchView); 

        // NEW: Clear search input button logic
        searchInput.addEventListener('input', () => {
            if (searchInput.value.length > 0) {
                clearSearchInputBtn.classList.remove('hidden');
            } else {
                clearSearchInputBtn.classList.add('hidden');
            }
            lucide.createIcons(); // Re-render Lucide icons if needed
        });

        clearSearchInputBtn.addEventListener('click', () => {
            searchInput.value = '';
            clearSearchInputBtn.classList.add('hidden');
            renderSearchInitial(); // Show initial search state when cleared
            lucide.createIcons();
        });


        // Version Switcher Listeners
        const versionToggleBtnEl = getEl('version-toggle-btn');
        const versionMenuEl = getEl('version-menu');
        versionToggleBtnEl.addEventListener('click', (e) => { 
            e.stopPropagation(); 
            state.isVersionDropdownOpen = !state.isVersionDropdownOpen; 
            renderVersionDropdown(); 
            console.log(`Version dropdown toggled. Open: ${state.isVersionDropdownOpen}`);
        });
        document.addEventListener('click', () => { 
            if (state.isVersionDropdownOpen) { 
                state.isVersionDropdownOpen = false; 
                renderVersionDropdown(); 
                console.log("Version dropdown closed by outside click.");
            } 
        });
        versionMenuEl.addEventListener('click', (e) => {
            const item = e.target.closest('.version-item');
            if (item) {
                e.stopPropagation(); 
                const versionId = item.dataset.versionId;
                if (state.selectedVersionId !== versionId) {
                    console.log(`Version changed from ${state.selectedVersionId} to ${versionId}.`);
                    state.selectedVersionId = versionId; 
                    localStorage.setItem('selectedVersionId', versionId);
                    const newVersion = state.versions.find(v => v.id === versionId);
                    showNotification(translations[state.selectedLanguage].switchedToVersion(newVersion.name), 'info'); 
                }
                state.isVersionDropdownOpen = false; 
                renderVersionDropdown();
            }
        });

        userAccountBtn.addEventListener('click', () => {
            console.log("User account button clicked.");
            if (!state.isLoggedIn) {
                console.log("User not logged in. Redirecting to login panel.");
                window.open('https://v1.sefgh.org/login', '_blank');
            } else {
                console.log("User is logged in. (No action defined for logged-in state yet).");
            }
        });

        // NEW: Console buttons event listeners
        if (copyLogBtn) {
            copyLogBtn.addEventListener('click', copyConsoleLogs);
        }
        if (downloadLogBtn) {
            downloadLogBtn.addEventListener('click', downloadConsoleLogs);
        }
    };

    // --- Initialization ---
    const init = () => {
        console.log("init: Application initialization started.");
        htmlEl.className = state.theme;
        // Set initial icon for both theme toggle buttons
        const themeIconHtml = state.theme === 'light' ? '<i data-lucide="sun" class="w-5 h-5 text-yellow-500"></i>' : '<i data-lucide="moon" class="w-5 h-5 text-indigo-400"></i>';
        if (mainHeaderThemeToggleBtn) mainHeaderThemeToggleBtn.innerHTML = themeIconHtml;
        if (mobileNavThemeToggleBtn) mobileNavThemeToggleBtn.innerHTML = themeIconHtml;
        
        renderMessages();
        renderSearchInitial();
        renderHistoryPanel(); 
        renderVersionDropdown(); 
        setActiveView('chat'); // Initial view is chat only
        updateChatInputState();
        setupConsoleLogger(); // NEW: Setup console log capturing
        setupEventListeners();
        lucide.createIcons();
        setLanguage(state.selectedLanguage); // Apply saved language on init

        window.addEventListener('resize', debounce(() => {
            console.log("Window resized. Re-evaluating active view layout.");
            setActiveView(state.activeView); 
        }, 200));
        console.log("init: Application initialization complete.");
    };
    
    // --- Run application ---
    init();
});
</script>

</body>
</html>
